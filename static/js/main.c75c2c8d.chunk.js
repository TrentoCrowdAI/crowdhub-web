(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{186:function(e,t,n){e.exports=n.p+"static/media/menu.7d88ba55.svg"},201:function(e,t,n){e.exports=n(414)},206:function(e,t,n){},209:function(e,t,n){},372:function(e,t,n){},373:function(e,t,n){},377:function(e,t,n){},378:function(e,t,n){},381:function(e,t,n){},404:function(e,t,n){},405:function(e,t,n){},408:function(e,t,n){},414:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(38),c=n.n(o),l=(n(206),n(4)),i=n(5),s=n(8),u=n(3),d=n(7),p=n(431),m=(n(207),n(208),n(416)),f=n(125),h=n.n(f),v=(n(209),function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{id:"sidebar",className:this.props.sidebarOpen?"open":""},r.a.createElement("h2",{className:"app-title"},"Servant"),r.a.createElement(h.a,{as:"ul"},r.a.createElement(h.a.Item,{as:"li",className:"sidebar-link"},r.a.createElement(m.a,{to:"/projects"},"Projects"))))}}]),t}(a.Component)),b=n(186),E=n.n(b),k=n(430),g=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(k.a,{className:"light-background",expand:"lg"},r.a.createElement("button",{className:"navbar-toggle button-link",onClick:this.props.onToggleSidebar},r.a.createElement("img",{src:E.a,className:"menu-icon",alt:"Toggle sidebar"})))}}]),t}(a.Component),j=n(433),y=n(200),w=n(432),O=n(6),C=n.n(O),D=n(12),M=n(420),x=n(434),S=n(421),T=n(189),B=n(417),N=n(126);function P(e,t){return I.apply(this,arguments)}function I(){return(I=Object(D.a)(C.a.mark(function e(t,n){var a,r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,n);case 2:if(a=e.sent,W(a)){e.next=7;break}throw(r=new Error("HTTP response code not 200")).status=a.status,r;case 7:return e.next=9,a.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var W=function(e){return e.status>=200&&e.status<=299};function U(e,t){return V.apply(this,arguments)}function V(){return(V=Object(D.a)(C.a.mark(function e(t,n){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(e,t){return F.apply(this,arguments)}function F(){return(F=Object(D.a)(C.a.mark(function e(t,n){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return(L=Object(D.a)(C.a.mark(function e(t,n){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z(e){return G.apply(this,arguments)}function G(){return(G=Object(D.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t,{method:"DELETE"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(e){var t=!1;return{result:new Promise(function(n,a){e.then(function(e){t||n(e)}).catch(function(e){t||a(e)})}),cancel:function(){return t=!0}}}var _="https://crowdai-servant-api-dev.herokuapp.com",H="".concat(_,"/projects"),J={INVALID_WORKFLOW_DATA:"invalid_project_data"};function K(e){return e.id=parseInt(e.id),e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e.deleted_ad=new Date(e.deleted_ad),e}function Y(e){return e}var $={getProjects:function(){var e=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(H);case 2:return t=e.sent,e.abrupt("return",t.map(K));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),getProject:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("".concat(H,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",K(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createProject:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Y(t),e.next=3,A("".concat(H),n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),updateProject:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=Y(t),e.next=4,R("".concat(H,"/").concat(t.id),n);case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(0),400!==e.t0.response){e.next=13;break}throw new Error(J.INVALID_PROJECT_DATA);case 13:throw e.t0;case 14:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),deleteProject:function(){var e=Object(D.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z("".concat(H,"/").concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Q=function(e){var t=e.to,n=e.children;return r.a.createElement("li",{className:"breadcrumb-item"},r.a.createElement(N.a,{to:t},n))},X=function(e){var t=e.children;return r.a.createElement("li",{className:"breadcrumb-item"},t)},Z=n(419),ee=n(427),te=n(418),ne=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShowModal=function(){return n.setState({show:!0})},n.onCloseModal=function(){return n.setState({show:!1})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement(ae,Object.assign({show:this.state.show,onCancel:this.onCloseModal},this.props)),r.a.createElement("a",{className:"icon-button delete",onClick:(e=this.onShowModal,function(t){t.stopPropagation(),e()})},r.a.createElement("i",{className:"fas fa-trash-alt"})));var e}}]),t}(a.Component),ae=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={deleting:!1,deleteError:!1},n.onCancel=function(){return n.props.onCancel()},n.onConfirmDeletion=Object(D.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.onDeleting(),e.prev=1,e.next=4,n.props.serviceCall();case 4:n.onDeleted(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n.onDeleteError();case 10:case"end":return e.stop()}},e,null,[[1,7]])})),n.onDeleting=function(){return n.setState({deleting:!0,deleteError:!1})},n.onDeleteError=function(){return n.setState({deleting:!1,deleteError:!0})},n.onDeleted=function(){n.setState({deleting:!1,deleteError:!1}),n.props.onDeleted()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ee.a,{show:this.props.show},r.a.createElement(ee.a.Header,null,this.props.header),r.a.createElement(ee.a.Body,null,this.state.deleteError&&r.a.createElement(B.a,{variant:"danger"},"There's been an error with the deleting request."),this.props.body),r.a.createElement(ee.a.Footer,null,r.a.createElement(te.a,{variant:"secondary",onClick:this.onCancel,disabled:this.state.deleting},"Cancel"),r.a.createElement(te.a,{variant:"danger",className:"confirm",onClick:this.onConfirmDeletion,disabled:this.state.deleting},"Delete")))}}]),t}(a.Component),re=function(e){var t=e.projects,n=e.onProjectDeleted;return r.a.createElement(T.a,null,r.a.createElement(Z.a,{hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement(oe,{project:e,key:e.id,onProjectDeleted:n})}))))},oe=function(e){var t=e.project,n=e.onProjectDeleted,a="".concat(Pn,"/").concat(t.id),o="".concat(Pn,"/").concat(t.id,"/edit");return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(N.a,{to:a},t.id)),r.a.createElement("td",null,r.a.createElement(N.a,{to:a},t.data.name)),r.a.createElement("td",null,t.data.description),r.a.createElement("td",null,r.a.createElement(N.a,{to:o,className:"icon-button"},r.a.createElement("i",{className:"fas fa-edit"})),r.a.createElement(ce,{project:t,onProjectDeleted:n})))},ce=function(e){var t=e.project,n=e.onProjectDeleted;return r.a.createElement(ne,{onDeleted:n,serviceCall:function(){return $.deleteProject(t)},header:r.a.createElement(ee.a.Title,null,"Delete project ",r.a.createElement("span",{className:"project-id"},"#",t.id)),body:r.a.createElement("div",null,"Are you sure you want to delete the project ",r.a.createElement("strong",null,t.data.name),"?")})},le=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},n.componentDidMount=function(){return n.fetchProjects()},n.componentWillUnmount=function(){return n.pendingProjectsRequest.cancel()},n.fetchProjects=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.pendingProjectsRequest=q($.getProjects()),e.next=4,n.pendingProjectsRequest.result;case 4:t=e.sent,n.setState({projects:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.setState({projects:null,fetchError:!0});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(M.a,null,r.a.createElement(x.a,null,r.a.createElement(X,null,"Projects")),r.a.createElement(S.a,{className:"header-row"},r.a.createElement(T.a,null,r.a.createElement("h3",null,"Projects list")),r.a.createElement(T.a,{className:"d-flex flex-row-reverse"},r.a.createElement(N.a,{className:"btn btn-primary",to:"".concat(Pn,"/new")},"New"))),r.a.createElement(S.a,null,!this.state.projects&&!this.state.fetchError&&r.a.createElement(ie,null),!this.state.projects&&this.state.fetchError&&r.a.createElement(ue,null),this.state.projects&&0===this.state.projects.length&&r.a.createElement(se,null),this.state.projects&&this.state.projects.length>0&&r.a.createElement(re,{projects:this.state.projects,onProjectDeleted:this.fetchProjects})))}}]),t}(a.Component),ie=function(){return r.a.createElement(T.a,null,r.a.createElement("p",null,"Fetching projects ..."))},se=function(){return r.a.createElement(T.a,null,r.a.createElement("p",null,"You haven't created any project yet. Use the 'Add' button to create a new one"))},ue=function(){return r.a.createElement(T.a,null,r.a.createElement(M.a,null,r.a.createElement(B.a,{variant:"danger"},"There's been an error while fetching the projects")))},de=n(428),pe=n(98),me=n(43),fe=(n(372),n(194)),he=n.n(fe),ve=n(195),be=n.n(ve),Ee=(n(373),function(e){var t=e.to,n=e.text;return r.a.createElement(N.a,{to:t,className:"btn btn-outline-primary back-button"},r.a.createElement("i",{className:"fas fa-arrow-left"})," ",n)}),ke=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},n.handleSubmit=function(e,t){var a=n.valuesToProjectData(e);n.props.onSubmit(a,t)},n.valuesToProjectData=function(e){return{name:e.name,description:e.description}},n.projectDataToValues=function(e){var t=e||{};return{name:t.name||"",description:t.description||""}},n.validationSchema=me.object().shape({name:me.string().required("Name is required"),description:me.string().required("Description is required")}),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"project-form-container"},r.a.createElement(pe.a,{initialValues:this.projectDataToValues(this.props.projectData),onSubmit:this.handleSubmit,validationSchema:this.validationSchema},function(t){var n=t.handleSubmit,a=t.handleChange,o=t.handleBlur,c=t.values,l=t.touched,i=t.errors,s=function(e){return l[e]&&!i[e]},u=function(e){return l[e]&&i[e]};return r.a.createElement(de.a,{onSubmit:n,noValidate:!0},r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Project name"),r.a.createElement(de.a.Control,{name:"name",type:"text",value:c.name,onChange:a,onBlur:o,placeholder:"Ex: classify category of papers",isInvalid:u("name"),isValid:s("name")}),r.a.createElement(de.a.Control.Feedback,{type:"invalid"},i.name)))),r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Project description"),r.a.createElement(de.a.Control,{name:"description",value:c.description,as:"textarea",rows:"3",onChange:a,onBlur:o,isInvalid:u("description"),isValid:s("description")}),r.a.createElement(de.a.Control.Feedback,{type:"invalid"},i.description)))),r.a.createElement(he.a,{className:"form-buttons"},r.a.createElement(Ee,{to:e.props.cancelButtonUrlDestination||"/",text:e.props.cancelText}),r.a.createElement(be.a,{variant:"primary",type:"submit",className:"submit-project-form"},e.props.submitText)))}))}}]),t}(a.Component),ge=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={creationError:!1},n.handleProjectSubmission=function(){var e=Object(D.a)(C.a.mark(function e(t,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.setSubmitting)(!0),e.prev=2,e.next=5,$.createProject({data:t});case 5:n.redirectToProjectsList(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.onProjectCreationFailed();case 11:r(!1);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onProjectCreationFailed=function(){return n.setState({creationError:!0})},n.redirectToProjectsList=function(){return n.props.history.push(Pn)},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(M.a,null,r.a.createElement(x.a,null,r.a.createElement(Q,{to:Pn},"Projects"),r.a.createElement(X,null,"New")),r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement("h1",null,"Create new project"))),this.state.creationError&&r.a.createElement(je,null),r.a.createElement(ke,{cancelButtonUrlDestination:Pn,cancelText:"Back to Projects",onSubmit:this.handleProjectSubmission,submitText:"Create"}))}}]),t}(a.Component),je=function(){return r.a.createElement(T.a,null,r.a.createElement(B.a,{variant:"danger"},"There's been an error while creating the project"))},ye=n(429),we=n(426),Oe=function(e){return e.props.history.push("".concat(Pn))},Ce="".concat(_,"/workflows"),De="invalid_workflow_data";function Me(e){return e.projectId=parseInt(e.id_project),delete e.id_project,e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e.deleted_ad=new Date(e.deleted_ad),e}function xe(e){return e.id_project=e.projectId,delete e.projectId,e}var Se={getWorkflowsOfProject:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("".concat(Ce,"?projectId=").concat(t.id));case 2:return n=e.sent,e.abrupt("return",n.map(Me));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getWorkflow:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("".concat(Ce,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",Me(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createWorkflow:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=xe(t),e.next=3,A("".concat(Ce),n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),updateWorkflow:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("[WorkflowService] updateWorkflow",t),e.prev=1,n=xe(t),e.next=5,R("".concat(Ce,"/").concat(t.id),n);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(1),400!==e.t0.response){e.next=14;break}throw new Error(De);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),deleteWorkflow:function(){var e=Object(D.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z("".concat(Ce,"/").concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Te=(n(377),n(422)),Be=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).validationSchema=me.object().shape({name:me.string().required("Name is required"),description:me.string().required("Description is required")}),n.handleSubmit=function(){var e=Object(D.a)(C.a.mark(function e(t,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.valuesToWorkspaceData(t),e.next=3,n.props.onSubmit(r,a);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.workspaceDataToValues=function(e){var t=e||{};return{name:t.name||"",description:t.description||""}},n.valuesToWorkspaceData=function(e){return{name:e.name,description:e.description}},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(pe.a,{initialValues:this.workspaceDataToValues(this.props.workspaceData),onSubmit:this.handleSubmit,validationSchema:this.validationSchema},function(t){var n=t.handleSubmit,a=t.handleChange,o=t.handleBlur,c=t.values,l=t.touched,i=t.errors,s=function(e){return l[e]&&!i[e]},u=function(e){return l[e]&&i[e]};return r.a.createElement(de.a,{onSubmit:n,noValidate:!0},r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Workflow name name"),r.a.createElement(de.a.Control,{name:"name",type:"text",value:c.name,onChange:a,onBlur:o,isInvalid:u("name"),isValid:s("name")}),r.a.createElement(de.a.Control.Feedback,{type:"invalid"},i.name)))),r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Workflow description"),r.a.createElement(de.a.Control,{name:"description",value:c.description,as:"textarea",rows:"3",onChange:a,onBlur:o,isInvalid:u("description"),isValid:s("description")}),r.a.createElement(de.a.Control.Feedback,{type:"invalid"},i.description)))),r.a.createElement(Te.a,{className:"form-buttons"},r.a.createElement(te.a,{variant:"secondary",onClick:e.props.onCancel},"Cancel"),r.a.createElement(te.a,{type:"submit"},e.props.submitText)))})}}]),t}(a.Component),Ne=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showModal:!1},n.showCreateWorkflowModal=function(){return n.setState({showModal:!0})},n.onWorkflowCreated=function(){n.hideCreateWorkflowModal(),n.props.onWorkflowCreated()},n.hideCreateWorkflowModal=function(){return n.setState({showModal:!1})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Pe,{show:this.state.showModal,onCancel:this.hideCreateWorkflowModal,projectId:this.props.projectId,onWorkflowCreated:this.onWorkflowCreated}),r.a.createElement(te.a,{onClick:this.showCreateWorkflowModal},"Add workflow"))}}]),t}(a.Component),Pe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={creationError:!1},n.createNewWorkflow=function(){var e=Object(D.a)(C.a.mark(function e(t,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.setSubmitting)(!0),e.prev=2,e.next=5,Se.createWorkflow({projectId:n.props.projectId,data:t});case 5:n.onWorkflowCreated(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.onWorkflowCreationError();case 11:r(!1);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onWorkflowCreated=function(){return n.props.onWorkflowCreated()},n.onWorkflowCreationError=function(){return n.setState({creationError:!0})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ee.a,{show:this.props.show},r.a.createElement(ee.a.Header,null,r.a.createElement(ee.a.Title,null,"Create new workflow")),r.a.createElement(ee.a.Body,null,this.state.creationError&&r.a.createElement(Ie,null),r.a.createElement(Be,{onCancel:this.props.onCancel,submitText:"Create",onSubmit:this.createNewWorkflow})))}}]),t}(a.Component),Ie=function(){return r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(B.a,{variant:"danger"},"There's been an error while creating the new workflow.")))},We=n(31),Ue=n(424),Ve=(n(378),n(26)),Ae=(n(380),n(381),n(63)),Fe=n(70),Re=n.n(Fe),Le=n(93),ze=function(){function e(t,n){Object(l.a)(this,e),this.definition=null,this.block=null,this.deSerialize(t,n)}return Object(i.a)(e,[{key:"deSerialize",value:function(e,t){this.definition=e,this.block=t,t.parameters&&void 0!==t.parameters[this.getName()]?this.value=t.parameters[this.getName()]:this.setValue(this.getDefinition().default)}},{key:"serialize",value:function(){return this.getValue()}},{key:"isValid",value:function(){return!1}},{key:"getDefinition",value:function(){return this.definition}},{key:"getName",value:function(){return this.getDefinition().name}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e}}]),e}(),Ge=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){if(this.getDefinition().required){var e=this.getValue();return e&&e.length>0}return!0}}]),t}(ze),qe={type:"text",Widget:function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=e.target.value;n.getModel().setValue(t),n.setState({value:t})},n.onBlur=function(){return n.props.onModelUpdated()},n.componentWillUnmount=n.onBlur,n.state={value:n.getModel().getValue()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,t.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},t.description),r.a.createElement(de.a.Control,{type:"text",value:this.state.value,onChange:this.onChange,onKeyUp:function(e){return e.stopPropagation()},onBlur:this.onBlur,isInvalid:!e.isValid()}),r.a.createElement(de.a.Control.Feedback,{type:"invalid"},t.displayName," is required"))}}]),t}(a.Component),Model:Ge},_e={type:"number",Model:function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return!0}}]),t}(ze),Widget:function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=e.target.value;n.getModel().setValue(t),n.setState({value:t})},n.onBlur=function(){return n.props.onModelUpdated()},n.componentWillUnmount=n.onBlur,n.state={value:n.getModel().getValue()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,t.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},t.description),r.a.createElement(de.a.Control,{type:"number",value:this.state.value,onChange:this.onChange,onKeyUp:function(e){return e.stopPropagation()},onBlur:this.onBlur,isInvalid:!e.isValid()}),r.a.createElement(de.a.Control.Feedback,{type:"invalid"},t.displayName," is required"))}}]),t}(a.Component)},He={type:"boolean",Model:function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return!0}}]),t}(ze),Widget:function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=e.target.checked;n.getModel().setValue(t),n.setState({value:t},n.props.onModelUpdated)},n.state={value:n.getModel().getValue()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel().getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,e.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},e.description),r.a.createElement(de.a.Check,{type:"checkbox",label:e.displayName,checked:this.state.value,onChange:this.onChange}))}}]),t}(a.Component)},Je=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){var e=this.getValue();return null!==this.getChoices().find(function(t){return t.value===e})}},{key:"getChoices",value:function(){return this.getDefinition().choices}}]),t}(ze),Ke={type:"textFromDropdown",Widget:function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onChangeValue=function(e){var t=e.target.value;n.getModel().setValue(t),n.props.onModelUpdated()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,t.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},t.description),r.a.createElement(de.a.Control,{as:"select",value:e.getValue(),onChange:this.onChangeValue},e.getChoices().map(function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)})))}}]),t}(a.Component),Model:Je},Ye=n(199),$e=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return!0}}]),t}(ze),Qe={type:"html",Widget:function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleEditorChange=function(e){n.getModel().setValue(e),n.props.onModelUpdated()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,e.getDisplayName()),r.a.createElement(de.a.Text,{className:"text-muted"},e.getDescription()),r.a.createElement(Ye.a,{onEditorChange:this.handleEditorChange,initialValue:e.getValue(),init:{menubar:!1}}))}}]),t}(a.Component),Model:$e},Xe=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return this.getChoices().length>0}},{key:"getChoices",value:function(){return this.getValue()}},{key:"setChoices",value:function(e){this.setValue(e)}},{key:"removeChoiceByIndex",value:function(e){this.getChoices().splice(e,1)}},{key:"addChoice",value:function(e){this.getChoices().push(e)}}]),t}(ze),Ze=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onRemoveChoice=function(e){n.getModel().removeChoiceByIndex(e),n.props.onModelUpdated()},n.onAddChoice=function(e){n.getModel().addChoice(e),n.props.onModelUpdated()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,t.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},t.description),r.a.createElement(et,{choices:e.getChoices(),onRemoveChoice:this.onRemoveChoice}),r.a.createElement(tt,{onAddChoice:this.onAddChoice}))}}]),t}(a.Component),et=function(e){var t=e.choices,n=e.onRemoveChoice;return r.a.createElement(Z.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Label"),r.a.createElement("th",null,"Value"),r.a.createElement("th",null))),r.a.createElement("tbody",null,t.map(function(e,t){return r.a.createElement("tr",{key:e.value},r.a.createElement("td",null,e.label),r.a.createElement("td",null,e.value),r.a.createElement("td",null,r.a.createElement("button",{className:"icon-button button-link",onClick:function(){return n(t)}},r.a.createElement("i",{className:"fas fa-trash-alt"}))))})))},tt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={label:"",value:""},n.isNewChoiceValid=function(){return n.state.label.length>0&&n.state.value.length>0},n.onAddChoice=function(){n.props.onAddChoice({label:n.state.label,value:n.state.value}),n.setState({label:"",value:""})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(de.a.Row,null,r.a.createElement(T.a,{md:"12",lg:"6"},r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Label"),r.a.createElement(de.a.Control,{name:"label",type:"text",value:this.state.label,onChange:function(t){return e.setState({label:t.target.value})}}))),r.a.createElement(T.a,{md:"12",lg:"6"},r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Value"),r.a.createElement(de.a.Control,{name:"value",type:"text",value:this.state.value,onChange:function(t){return e.setState({value:t.target.value})}}))),r.a.createElement(T.a,{md:"12",className:""},r.a.createElement(te.a,{onClick:this.onAddChoice,disabled:!this.isNewChoiceValid()},"Add")))}}]),t}(a.Component),nt={type:"choiceBuilder",Widget:Ze,Model:Xe},at=n(423),rt=n(193),ot=n(196),ct=n.n(ot),lt=(n(389),n(391),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.showModal=function(){return n.setState({show:!0})},n.hideModal=function(){return n.setState({show:!1})},n.onSave=function(e){n.props.onUpdateCode(e),n.hideModal()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(te.a,{className:"btn-block",onClick:this.showModal},"Open editor"),r.a.createElement(it,{show:this.state.show,onClose:this.hideModal,onSave:this.onSave,code:this.props.code}))}}]),t}(a.Component)),it=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).onCodeEdited=function(e){return n.setState({code:e})},n.onSave=function(){return n.props.onSave(n.state.code)},n.state={code:n.props.code},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ee.a,{show:this.props.show,size:"lg"},r.a.createElement(ee.a.Header,null,"Lambda block code editor"),r.a.createElement(ee.a.Body,null,r.a.createElement(st,{onFilePicked:this.onCodeEdited}),r.a.createElement("hr",null),r.a.createElement(ut,{code:this.state.code,onCodeEdited:this.onCodeEdited})),r.a.createElement(ee.a.Footer,null,r.a.createElement(te.a,{variant:"secondary",onClick:this.props.onClose},"Cancel"),r.a.createElement(te.a,{onClick:this.onSave},"Save")))}}]),t}(a.Component),st=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",content:null},n.onChange=function(e){var t=e.target.files;1===t.length&&n.onPickFile(t[0])},n.onPickFile=function(){var e=Object(D.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.t1=t.name,e.next=4,n.readFileContent(t);case 4:e.t2=e.sent,e.t3={name:e.t1,content:e.t2},e.t0.setState.call(e.t0,e.t3);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.readFileContent=function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise(function(e,a){n.addEventListener("load",function(t){return e(t.target.result)}),n.readAsText(t)}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onImport=function(){return n.props.onFilePicked(n.state.content)},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h5",null,"Import from file"),r.a.createElement(at.a,null,r.a.createElement(at.a.Prepend,null,r.a.createElement("label",{className:"btn btn-primary"},"Select file",r.a.createElement("input",{type:"file",style:{display:"none"},accept:".js",multiple:!1,onChange:this.onChange}))),r.a.createElement(rt.a,{value:this.state.name,placeholder:"Click the left button or drop a file",readonly:!0}),r.a.createElement(at.a.Append,null,r.a.createElement(te.a,{style:{height:"24px",boxSizing:"content-box"},disabled:null===this.state.content,onClick:this.onImport},"Import"))))}}]),t}(a.Component),ut=function(e){var t=e.onCodeEdited,n=e.code;return r.a.createElement("div",null,r.a.createElement("h5",null,"Editor"),r.a.createElement(ct.a,{style:{width:"100%"},placeholder:"Lambda block code",mode:"javascript",theme:"monokai",name:"lambdaBlockCodeEditor",onChange:t,fontSize:14,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,value:n,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2}}))},dt=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return!0}},{key:"getCode",value:function(){return this.getValue()}},{key:"setCode",value:function(e){this.setValue(e)}}]),t}(ze),pt=function(e){var t={};return e.forEach(function(e){return t[e.type]=e}),t}([qe,_e,He,Ke,Qe,nt,{type:"code",Widget:function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onUpdateCode=function(e){n.getModel().setCode(e),n.props.onModelUpdated()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,t.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},t.description),r.a.createElement(lt,{code:e.getCode(),onUpdateCode:this.onUpdateCode}))}}]),t}(a.Component),Model:dt}]),mt=n(197),ft=n.n(mt),ht=(n(403),n(435)),vt=function(e){var t=e.componentsContainerRef,n=e.designBlockTypeDefinitions;return r.a.createElement("div",null,r.a.createElement("h5",null,"Design blocks"),r.a.createElement("div",{ref:t},n.map(function(e){return r.a.createElement(ht.a,{key:e.name,"data-block-type-definition":JSON.stringify(e),className:"mb-2"},r.a.createElement(ht.a.Header,null,e.displayName))})))},bt=n(187),Et=(n(404),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={expanded:!1},n.toggleExpansion=function(){return n.setState(function(e){return{expanded:!e.expanded}})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ht.a,{className:"block-card"},r.a.createElement(ht.a.Header,null,r.a.createElement("div",{onClick:this.toggleExpansion},r.a.createElement("div",null,this.props.invalid&&r.a.createElement("i",{className:"fas fa-exclamation-triangle"}),this.props.title),r.a.createElement("i",{className:"fas fa-caret-down ".concat(this.state.expanded?"expanded":"collapsed")}))),r.a.createElement(bt.a,{in:this.state.expanded},r.a.createElement("div",null,r.a.createElement(ht.a.Body,null,this.props.children))))}}]),t}(a.Component)),kt=function(e){var t=e.parametrizedBlock,n=e.onParameterModelUpdate,a=t.getId(),o=t.getParameterModelsMap(),c=t.getParameterDefinitionList();return r.a.createElement("div",null,c.map(function(e){var t=Ft[e.type],c="".concat(a,"-").concat(e.name),l=o[e.name];if(t){var i=t.Widget;return r.a.createElement("div",{key:c},r.a.createElement(i,{model:l,onModelUpdated:n}),r.a.createElement("hr",null))}return r.a.createElement(gt,{key:c,parameter:e})}))},gt=function(e){var t=e.parameter;return r.a.createElement(B.a,{variant:"danger"},"Error: Unknown parameter '",t.name,"' of type '",t.type,"'.")},jt=function(e){var t=e.componentsContainerRef,n=e.designBlocksModel,a=e.onParameterModelUpdate;return r.a.createElement("div",null,r.a.createElement("h5",null,"Your job design"),r.a.createElement("div",{ref:t,style:{minHeight:"100px"}},n.getBlockModels().map(function(e){return r.a.createElement(yt,{designBlockTypeDefinitions:n.getDesignBlockTypeDefinitions(),key:e.getId(),designBlockModel:e,onParameterModelUpdate:a})})))},yt=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.designBlockModel,n=e.onParameterModelUpdate;return r.a.createElement("div",{"data-block-id":t.getId()},r.a.createElement(Et,{title:t.getDesignBlockTypeDefinition().displayName,invalid:!t.isValid()},r.a.createElement(kt,{parametrizedBlock:t,onParameterModelUpdate:n})))}}]),t}(a.Component),wt=function(){function e(t,n){var a=this;Object(l.a)(this,e),this.isValid=function(){return null==Object.values(a.getParameterModelsMap()).find(function(e){return!e.isValid()})},this.deSerialize(t,n)}return Object(i.a)(e,[{key:"deSerialize",value:function(e,t){this.setDesignBlockTypeDefinition(e),this.type=t?t.type:e.name,this.id=t&&t.id?t.id:Re()(),this.setParameterModelsMap(Rt(t||{},e.parameterDefinitions))}},{key:"setDesignBlockTypeDefinition",value:function(e){this.designBlockTypeDefinition=e}},{key:"getDesignBlockTypeDefinition",value:function(){return this.designBlockTypeDefinition}},{key:"serialize",value:function(){return{id:this.id,type:this.type,parameters:Lt(this.getParameterModelsMap())}}},{key:"getId",value:function(){return this.id}},{key:"getParameterModelsMap",value:function(){return this.parameterModelsMap}},{key:"setParameterModelsMap",value:function(e){this.parameterModelsMap=e}},{key:"getParameterDefinitionList",value:function(){return this.getDesignBlockTypeDefinition().parameterDefinitions}}]),e}(),Ot=function(e,t){for(var n=0;n<t.children.length;n++)if(t.children[n]===e)return n;return-1},Ct=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).blockTypesRef=null,n.blocksRef=null,n.drake=null,n.componentDidMount=function(){return n.setupDragula()},n.setupDragula=function(){var e=n.blockTypesRef.current,t=n.blocksRef.current,a=[e,t];n.drake=ft()(a,{copy:function(t,n){return n===e},accepts:function(e,n){return n===t},removeOnSpill:!0}),n.drake.on("drop",function(a,r,o,c){if(r===t){var l=Ot(c,t);o===e?n.onBlockAdded(a,l):n.onBlockSorted(a,l)}}),n.drake.on("remove",function(e,t){t.appendChild(e);var a=e.getAttribute("data-block-id");n.getModel().removeBlockById(a),n.props.onModelUpdated()})},n.onBlockAdded=function(e,t){n.assertNextSiblingIndexIsValidGivenInitialBlocks(t);var a=n.getNewBlockIndexGivenNextSiblingIndex(t),r=n.buildNewBlockDataGivenClonedElement(e);n.addBlockDataToTheDesignAndNotify(r,a),e.parentNode.removeChild(e)},n.assertNextSiblingIndexIsValidGivenInitialBlocks=function(e){if(0===e||e>n.getBlockModels().length)throw new Error("invalid nextSiblingIndex given the current blocks array")},n.getNewBlockIndexGivenNextSiblingIndex=function(e){return-1===e?n.getBlockModels().length:e-1},n.buildNewBlockDataGivenClonedElement=function(e){var t=JSON.parse(e.getAttribute("data-block-type-definition"));return new wt(t)},n.addBlockDataToTheDesignAndNotify=function(e,t){n.getModel().addBlock(e,t),n.forceUpdate()},n.onBlockSorted=function(e,t){n.assertNextSiblingIndexIsValidGivenInitialBlocks(t);var a=n.getMovedBlockIndex(e),r=n.getBlockIndexGivenNextSiblingIndex(t);n.getModel().swapBlocks(a,r),n.props.onModelUpdated()},n.getMovedBlockIndex=function(e){var t=n.getModel().getBlocks(),a=e.getAttribute("data-block-id");return t.findIndex(function(e){return e.id===a})},n.getBlockIndexGivenNextSiblingIndex=function(e){return-1===e?n.getBlockModels().length-1:e-1},n.blockTypesRef=r.a.createRef(),n.blocksRef=r.a.createRef(),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.designBlocksModel}},{key:"getBlockModels",value:function(){return this.getModel().getBlockModels()}},{key:"render",value:function(){return r.a.createElement(S.a,null,r.a.createElement(T.a,{md:"6",lg:"4"},r.a.createElement(vt,{designBlockTypeDefinitions:this.getModel().getDesignBlockTypeDefinitions(),componentsContainerRef:this.blockTypesRef})),r.a.createElement(T.a,{md:"6",lg:"8"},r.a.createElement(jt,{componentsContainerRef:this.blocksRef,designBlocksModel:this.getModel(),onParameterModelUpdate:this.props.onModelUpdated})))}}]),t}(a.Component),Dt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={show:!1},n.showModal=function(){return n.setState({show:!0})},n.hideModal=function(){return n.setState({show:!1})},n.onSave=function(){n.getModel().setBlocksModel(n.designBlocksClonedModel),n.props.onModelUpdated(),n.hideModal()},n.designBlocksClonedModel=n.cloneDesignBlocksModel(),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){this.props.templateJustPicked&&(this.designBlocksClonedModel=this.cloneDesignBlocksModel(),this.props.onModelUpdated())}},{key:"getModel",value:function(){return this.props.designModel}},{key:"cloneDesignBlocksModel",value:function(){return this.getModel().getBlocksModel().clone()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Mt,{show:this.state.show,designBlocksModel:this.designBlocksClonedModel,onClose:this.hideModal,onSave:this.onSave}),r.a.createElement(te.a,{className:"btn-block",onClick:this.showModal},this.props.buttonText))}}]),t}(a.Component),Mt=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.designBlocksModel,a=t.onSave,o=t.onClose;return r.a.createElement(ee.a,{show:this.props.show,size:"lg"},r.a.createElement(ee.a.Header,null,"Do block design editor"),r.a.createElement(ee.a.Body,null,r.a.createElement(Ct,{designBlocksModel:n,onModelUpdated:function(){return e.forceUpdate()}})),r.a.createElement(ee.a.Footer,null,r.a.createElement(te.a,{variant:"secondary",onClick:o},"Cancel"),r.a.createElement(te.a,{onClick:a,disabled:!n.isValid()},"Save")))}}]),t}(a.Component),xt=function(){function e(t,n){Object(l.a)(this,e),this.deSerialize(t,n)}return Object(i.a)(e,[{key:"deSerialize",value:function(e,t){var n=this;this.setDesignBlockTypeDefinitions(e),this.setBlockModels(t.map(function(e){return new wt(n.getDesignBlockTypeDefinition(e.type),e)}))}},{key:"setDesignBlockTypeDefinitions",value:function(e){this.designBlockTypeDefinitions=e}},{key:"getDesignBlockTypeDefinition",value:function(e){return this.getDesignBlockTypeDefinitions().find(function(t){return t.name===e})}},{key:"getDesignBlockTypeDefinitions",value:function(){return this.designBlockTypeDefinitions}},{key:"getBlockModels",value:function(){return this.blockModels}},{key:"setBlockModels",value:function(e){this.blockModels=e}},{key:"clone",value:function(){return new e(this.getDesignBlockTypeDefinitions(),this.serialize())}},{key:"serialize",value:function(){return this.getBlockModels().map(function(e){return e.serialize()})}},{key:"isDesignEmpty",value:function(){return 0===this.getBlockModels().length}},{key:"addBlock",value:function(e,t){this.getBlockModels().splice(t,0,e)}},{key:"swapBlocks",value:function(e,t){var n=this.getBlockModels(),a=n[e];n[e]=n[t],n[t]=a}},{key:"removeBlockById",value:function(e){var t=this.getBlockModels(),n=t.findIndex(function(t){return t.id===e});n>=0&&t.splice(n,1)}},{key:"isValid",value:function(){return null==this.getBlockModels().find(function(e){return!e.isValid()})}}]),e}(),St=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"deSerialize",value:function(e,n){Object(Ae.a)(Object(u.a)(t.prototype),"deSerialize",this).call(this,e,n),this.setBlocksModel(new xt(e.designBlockTypeDefinitions,this.getDesign().blocks))}},{key:"serialize",value:function(){return{blocks:this.getBlocksModel().serialize()}}},{key:"getDesign",value:function(){return this.getValue()}},{key:"getBlocksModel",value:function(){return this.blocksModel}},{key:"setBlocksModel",value:function(e){this.blocksModel=e}},{key:"isValid",value:function(){return this.getBlocksModel().isValid()}},{key:"isDesignEmpty",value:function(){return this.getBlocksModel().isDesignEmpty()}}]),t}(ze),Tt="".concat(_,"/template-do"),Bt=function(e){var t=e.id,n=e.data;return Object(We.a)({id:t},n)},Nt={getDoDesignTemplates:function(){var e=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(Tt);case 2:return t=e.sent,e.abrupt("return",t.map(Bt));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},Pt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShow=function(){return n.setState({show:!0})},n.onHide=function(){return n.setState({show:!1})},n.onTemplatePicked=function(e){n.onHide(),setTimeout(function(){n.getDesignModel().setBlocksModel(e),n.props.onModelUpdated()},200)},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getDesignBlockTypeDefinitions",value:function(){return this.getDesignModel().getBlocksModel().getDesignBlockTypeDefinitions()}},{key:"getDesignModel",value:function(){return this.props.designModel}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(It,{show:this.state.show,onHide:this.onHide,onTemplatePicked:this.onTemplatePicked,designBlockTypeDefinitions:this.getDesignBlockTypeDefinitions()}),r.a.createElement(te.a,{variant:"success",onClick:this.onShow,className:"btn-block mb-2"},"Create from a template"))}}]),t}(a.Component),It=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={templates:null,fetchError:!1},n.componentDidMount=function(){return n.fetchTemplates()},n.componentWillUnmount=function(){return n.pendingTemplatesRequest.cancel()},n.fetchTemplates=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({fetchError:!1}),e.prev=1,n.pendingTemplatesRequest=q(Nt.getDoDesignTemplates()),e.next=5,n.pendingTemplatesRequest.result;case 5:t=e.sent,n.setState({templates:t}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setState({fetchError:!0});case 12:case"end":return e.stop()}},e,null,[[1,9]])})),n.onTemplatePicked=function(e){var t=new xt(n.props.designBlockTypeDefinitions,e.blocks);n.props.onTemplatePicked(t)},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ee.a,{show:this.props.show,onHide:this.props.onHide,size:"lg"},r.a.createElement(ee.a.Header,null,"Pick a design template"),r.a.createElement(ee.a.Header,null,this.state.fetchError&&r.a.createElement(Wt,null),!this.state.templates&&!this.state.fetchError&&r.a.createElement(Ut,null),this.state.templates&&r.a.createElement(Vt,{templates:this.state.templates,onTemplatePicked:this.onTemplatePicked})),r.a.createElement(ee.a.Footer,null,r.a.createElement(te.a,{variant:"secondary",onClick:this.props.onHide},"Cancel")))}}]),t}(a.Component),Wt=function(){return r.a.createElement(B.a,{variant:"danger"},"There's been an error while fetching the templates")},Ut=function(){return r.a.createElement("p",null,"Loading...")},Vt=function(e){var t=e.templates,n=e.onTemplatePicked;return r.a.createElement(M.a,null,r.a.createElement(S.a,null,t.map(function(e){return r.a.createElement(T.a,{xs:12,sm:6,key:e.id},r.a.createElement(ht.a,null,r.a.createElement(ht.a.Header,null,e.name),r.a.createElement(ht.a.Body,null,e.description),r.a.createElement(ht.a.Footer,null,r.a.createElement(te.a,{onClick:function(){return n(e)}},"Choose"))))})))},At={type:"doDesign",Model:St,Widget:function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={templateJustPicked:!1},n.onModelUpdatedFromTemplate=function(){n.props.onModelUpdated(),n.setState({templateJustPicked:!0})},n.onModelUpdatedFromEditor=function(){n.props.onModelUpdated(),n.setState({templateJustPicked:!1})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,t.displayName),r.a.createElement(de.a.Text,{className:"text-muted"},t.description),e.isDesignEmpty()&&r.a.createElement(Pt,{designModel:e,onModelUpdated:this.onModelUpdatedFromTemplate}),r.a.createElement(Dt,{designModel:e,onModelUpdated:this.onModelUpdatedFromEditor,buttonText:e.isDesignEmpty()?"Create from scratch":"Open design editor",templateJustPicked:this.state.templateJustPicked}))}}]),t}(a.Component)},Ft=Object(We.a)({},pt,Object(Le.a)({},At.type,At)),Rt=function(e,t){var n={};return t.forEach(function(t){var a=t.name,r=zt(t.type);n[a]=new r(t,e)}),n},Lt=function(e){var t={};return Object.keys(e).forEach(function(n){return t[n]=e[n].serialize()}),t},zt=function(e){var t=Ft[e];if(!t)throw new Error("unknown parameter of type '".concat(e,"'"));return t.Model},Gt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).isValid=function(){return null==Object.values(n.getParameterModelsMap()).find(function(e){return!e.isValid()})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"deSerialize",value:function(e,n){e.id||(e.id=Re()(),e.ports=e.ports.map(function(e){return Object(We.a)({},e,{id:Re()()})})),Object(Ae.a)(Object(u.a)(t.prototype),"deSerialize",this).call(this,e,n),this.blockTypeDefinition=n.getBlockTypeDefinition(e.type),this.setParameterModelsMap(Rt(e,this.getParameterDefinitionList()))}},{key:"serialize",value:function(){return Object(We.a)({},Object(Ae.a)(Object(u.a)(t.prototype),"serialize",this).call(this),{type:this.blockTypeDefinition.name,parameters:Lt(this.getParameterModelsMap())})}},{key:"getId",value:function(){return this.id}},{key:"getParameterModelsMap",value:function(){return this.parameterModelsMap}},{key:"setParameterModelsMap",value:function(e){this.parameterModelsMap=e}},{key:"getParameterDefinitionList",value:function(){return this.blockTypeDefinition.parameterDefinitions}}]),t}(Ve.DefaultNodeModel),qt=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{position:"relative"}},!this.props.node.isValid()&&r.a.createElement("div",{style:{position:"absolute",color:"yellow",right:0}},r.a.createElement("i",{className:"fas fa-exclamation-triangle"})),Object(Ae.a)(Object(u.a)(t.prototype),"render",this).call(this))}}]),t}(Ve.DefaultNodeWidget),_t=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,"".concat(e,"Factory")))).setBlockType(e),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"setBlockType",value:function(e){this.blockType=e}},{key:"getType",value:function(){return this.getBlockType()}},{key:"getBlockType",value:function(){return this.blockType}},{key:"getNewInstance",value:function(){return new Gt}},{key:"generateReactWidget",value:function(e,t){return r.a.createElement(qt,{node:t,diagramEngine:e})}}]),t}(Ve.DefaultNodeFactory),Ht=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"generateLinkSegment",value:function(e,t,n,a){return r.a.createElement("path",{className:n?t.bem("--path-selected"):"",strokeWidth:e.width,stroke:"black",d:a})}}]),t}(Ve.DefaultLinkFactory),Jt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this))).setBlockTypeDefinitions(e),n.installFactories(),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"setBlockTypeDefinitions",value:function(e){this.blockTypeDefinitions=e}},{key:"installFactories",value:function(){var e=this;this.installDefaultFactories(),this.registerLinkFactory(new Ht),this.getBlockTypeDefinitions().forEach(function(t){return e.registerNodeFactory(new _t(t.name))})}},{key:"getBlockTypeDefinitions",value:function(){return this.blockTypeDefinitions}},{key:"getBlockTypeDefinition",value:function(e){return this.getBlockTypeDefinitions().find(function(t){return t.name===e})}}]),t}(Ve.DiagramEngine),Kt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).initGraph=function(){n.engine=new Jt(n.props.blockTypeDefinitions),n.engine.setDiagramModel(n.getModel()),n.engine.blockTypeDefinitions=n.props.blockTypeDefinitions},n.deserializeGraph=function(e){e&&e.id&&(n.getModel().deSerializeDiagram(e,n.engine),n.addSelectedListenerToNodesOfModel())},n.addSelectedListenerToNodesOfModel=function(){Object.values(n.getModel().getNodes()).forEach(n.addSelectedListener)},n.onDrop=function(e){n.isEventCausedByADroppedBlockType(e)&&n.onBlockTypeDropped(e)},n.isEventCausedByADroppedBlockType=function(e){return!!n.getBlockTypeDefinitionFromEvent(e)},n.onBlockTypeDropped=function(e){var t=n.getBlockTypeDefinitionFromEvent(e),a=n.getMousePosition(e);n.createNodeFromDroppedBlockType(t,a)},n.getBlockTypeDefinitionFromEvent=function(e){return JSON.parse(e.dataTransfer.getData("blockTypeDefinition"))},n.getMousePosition=function(e){return n.engine.getRelativeMousePoint(e)},n.createNodeFromDroppedBlockType=function(e,t){var a=n.createNodeFromBlockType(e,t);n.addNodeToGraph(a,e)},n.createNodeFromBlockType=function(e,t){var a=new Gt;return a.deSerialize({name:e.displayName,type:e.name,ports:e.ports,color:e.color,x:t.x,y:t.y},n.engine),a},n.addNodeToGraph=function(e){n.addSelectedListener(e),n.getModel().addNode(e),n.forceUpdate()},n.addSelectedListener=function(e){return e.addListener({selectionChanged:n.onSelectedNodeChanged,entityRemoved:n.onSelectedNodeChanged})},n.onSelectedNodeChanged=function(){var e=n.getSelectedNodes();if(1===e.length){var t=e[0];n.props.onNodeSelected(t)}else n.props.onNodeSelected(null)},n.getSelectedNodes=function(){return n.getModel().getSelectedItems("node")},n.getModel=function(){return n.props.graphModel},n.initGraph(),n.deserializeGraph(e.initialGraph),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{onDrop:this.onDrop,onDragOver:function(e){return e.preventDefault()},className:"full-height"},r.a.createElement(Ve.DiagramWidget,{diagramEngine:this.engine}))}}]),t}(a.Component),Yt=function(e){var t=e.blockTypeDefinitions;return r.a.createElement("div",null,r.a.createElement("h5",null,"Workflow blocks"),r.a.createElement(S.a,null,r.a.createElement(T.a,null,t.map(function(e){return r.a.createElement(ht.a,{key:e.id,className:"btn-block",style:{backgroundColor:e.color},draggable:!0,onDragStart:function(t){return t.dataTransfer.setData("blockTypeDefinition",JSON.stringify(e))}},r.a.createElement(ht.a.Header,null,e.displayName))}))))},$t=function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChangeName=function(e){return n.setState({name:e.target.value})},n.onChangeDescription=function(e){return n.setState({description:e.target.value})},n.onBlur=function(){return n.props.onEdit({name:n.state.name||n.props.name,description:n.state.description||n.props.description})};var a=e.workflowData,r=a.name,o=a.description;return n.state={name:r,description:o},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement("h5",null,"Workflow properties"))),r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Name"),r.a.createElement(de.a.Control,{name:"name",type:"text",value:this.state.name,onChange:this.onChangeName,onBlur:this.onBlur})))),r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(de.a.Group,null,r.a.createElement(de.a.Label,null,"Description"),r.a.createElement(de.a.Control,{name:"description",type:"text",as:"textarea",value:this.state.description,onChange:this.onChangeDescription,onBlur:this.onBlur})))))}}]),t}(a.Component),Qt=function(e){var t=e.node,n=e.onModelUpdate;return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement("h5",null,"Block parameters"))),r.a.createElement(kt,{parametrizedBlock:t,onParameterModelUpdate:n}))},Xt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).isValid=function(){return null==Object.values(n.nodes).find(function(e){return!e.isValid()})},n}return Object(d.a)(t,e),t}(Ve.DiagramModel),Zt="".concat(_,"/block-types"),en=function(e){var t=e.id,n=e.data;return{id:t,name:n.name,displayName:n.displayName,ports:n.ports,color:n.color,parameterDefinitions:n.parameterDefinitions}},tn={getBlockTypeDefinitions:function(){var e=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(Zt);case 2:return t=e.sent,e.abrupt("return",t.map(en));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},nn=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).graphModel=new Xt,n.state={blockTypeDefinitions:null,fetchBlockTypesError:!1,selectedNode:null},n.componentDidMount=function(){return n.fetchBlockTypes()},n.componentWillUnmount=function(){return n.pendingBlockTypesRequest.cancel()},n.onNodeSelected=function(e){return n.setState({selectedNode:e})},n.onSavePressed=function(){n.onWorkflowDataEdited(),n.props.onSave()},n.onWorkflowDataEdited=function(e){var t=Object(We.a)({},n.props.workflow);e&&(t.data=Object(We.a)({},t.data,e)),t.data.graph=n.graphModel.serializeDiagram(),n.props.onWorkflowEdited(t)},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"fetchBlockTypes",value:function(){var e=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.pendingBlockTypesRequest=q(tn.getBlockTypeDefinitions()),e.next=4,this.pendingBlockTypesRequest.result;case 4:t=e.sent,this.setState({blockTypeDefinitions:t,fetchBlockTypesError:!1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({fetchBlockTypesError:!0});case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.workflow,n=this.state.blockTypeDefinitions;return r.a.createElement(M.a,{className:"full-width",style:{flex:1,marginTop:"-1em"}},(!t||!n)&&r.a.createElement("p",null,"Loading ..."),t&&n&&r.a.createElement(S.a,{className:"full-height"},r.a.createElement(T.a,{xs:2,className:"light-background"},r.a.createElement(Yt,{blockTypeDefinitions:n})),r.a.createElement(T.a,{xs:7,className:"graph-editor-container",style:{display:"flex"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement(Kt,{initialGraph:t.data.graph,graphModel:this.graphModel,blockTypeDefinitions:n,onNodeSelected:this.onNodeSelected}),r.a.createElement(an,{workflow:t}),r.a.createElement(rn,{workflow:t,graphModel:this.graphModel,onSavePressed:this.onSavePressed,isSaving:this.props.isSaving}))),r.a.createElement(T.a,{xs:3,className:"light-background"},this.state.selectedNode&&r.a.createElement(Qt,{node:this.state.selectedNode,onModelUpdate:function(){return e.forceUpdate()}}),!this.state.selectedNode&&r.a.createElement($t,{workflowData:this.props.workflow.data,onEdit:this.onWorkflowDataEdited}))))}}]),t}(a.Component),an=function(e){var t=e.workflow;return r.a.createElement("div",{className:"workflow-breadcrumb"},r.a.createElement(x.a,null,r.a.createElement(Q,{to:Pn},"Projects"),r.a.createElement(X,null,"Hello world"),r.a.createElement(X,null,"Workflows"),r.a.createElement(X,null,t.data.name)))},rn=function(e){var t=e.workflow,n=e.graphModel,a=e.isSaving,o=e.onSavePressed,c=n.isValid();return r.a.createElement(k.a,{className:"light-background justify-content-between workflow-bottom-navbar"},r.a.createElement(Ee,{text:"Return to project",to:"".concat(Pn,"/").concat(t.projectId)}),r.a.createElement("div",null,!c&&r.a.createElement("span",null,r.a.createElement("i",{className:"fas fa-exclamation-triangle"})," Workflow contains some errors")),r.a.createElement(te.a,{disabled:!c||a,onClick:o},a&&r.a.createElement(Ue.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),r.a.createElement("span",null," Save")))},on=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={workflow:null,isSaving:!1,saveError:!1},n.componentDidMount=function(){return n.fetchWorkflow()},n.componentWillUnmount=function(){return n.pendingWorkflowRequest.cancel()},n.onWorkflowEdited=function(e){return n.setState({workflow:e})},n.onSave=Object(D.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isSaving:!0}),e.prev=1,e.next=4,Se.updateWorkflow(n.state.workflow);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),n.setState({saveError:!0});case 9:n.setState({isSaving:!1});case 10:case"end":return e.stop()}},e,null,[[1,6]])})),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"fetchWorkflow",value:function(){var e=Object(D.a)(C.a.mark(function e(){var t,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,this.pendingWorkflowRequest=q(Se.getWorkflow(t)),e.next=5,this.pendingWorkflowRequest.result;case 5:n=e.sent,this.setState({workflow:n}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(nn,{workflow:this.state.workflow,onWorkflowEdited:this.onWorkflowEdited,onSave:this.onSave,isSaving:this.state.isSaving,saveError:this.state.saveError})}}]),t}(a.Component),cn=function(){return r.a.createElement(j.a,null,r.a.createElement(y.a,{path:"".concat("/workflows","/:id"),exact:!0,component:on}))},ln=function(e){var t=e.workflows,n=e.onWorkflowDeleted;return r.a.createElement(Z.a,{hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement(sn,{workflow:e,key:e.id,onWorkflowDeleted:n})})))},sn=function(e){var t=e.workflow,n=e.onWorkflowDeleted,a="".concat("/workflows","/").concat(t.id);return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(N.a,{to:a},t.id)),r.a.createElement("td",null,r.a.createElement(N.a,{to:a},t.data.name)),r.a.createElement("td",null,t.data.description),r.a.createElement("td",null,r.a.createElement(un,{workflow:t,onWorkflowDeleted:n})))},un=function(e){var t=e.workflow,n=e.onWorkflowDeleted;return r.a.createElement(ne,{onDeleted:n,serviceCall:function(){return Se.deleteWorkflow(t)},header:r.a.createElement(ee.a.Title,null,"Delete worflow ",r.a.createElement("span",{className:"project-id"},t.name)),body:r.a.createElement("div",null,'Are you sure you want to delete "',r.a.createElement("strong",null,t.data.name),'"?')})},dn=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){return n.fetchWorkflows()},n.componentWillUnmount=function(){return n.pendingWorkflowsRequest.cancel()},n.fetchWorkflows=Object(D.a)(C.a.mark(function e(){var t,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({workflows:null}),e.prev=1,t=Se.getWorkflowsOfProject(n.props.project),n.pendingWorkflowsRequest=q(t),e.next=6,n.pendingWorkflowsRequest.result;case 6:a=e.sent,n.setState({workflows:a}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.setState({workflows:null,fetchError:!0});case 13:case"end":return e.stop()}},e,null,[[1,10]])})),n.onWorkflowCreated=function(){return n.fetchWorkflows()},n.state={projectId:e.project.id},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(M.a,null,r.a.createElement(S.a,{className:"header-row"},r.a.createElement(T.a,null,r.a.createElement("h3",null,"Workflows")),r.a.createElement(T.a,{className:"d-flex flex-row-reverse"},r.a.createElement("div",null,r.a.createElement(Ne,{projectId:this.state.projectId,onWorkflowCreated:this.onWorkflowCreated})))),r.a.createElement(S.a,null,r.a.createElement(T.a,null,!this.state.workflows&&r.a.createElement(pn,null),this.state.fetchError&&r.a.createElement(mn,null),this.state.workflows&&r.a.createElement(ln,{workflows:this.state.workflows,onWorkflowDeleted:this.fetchWorkflows}))))}}]),t}(a.Component),pn=function(){return r.a.createElement("p",null,"Fetching workflows...")},mn=function(){return r.a.createElement(T.a,null,r.a.createElement(M.a,null,r.a.createElement(B.a,{variant:"danger"},"There's been an error while fetching the workflows of the project")))},fn=n(425),hn="".concat(_,"/items");function vn(e){return e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e.deleted_ad=new Date(e.deleted_ad),e}var bn={importFromCsvUrl:function(){var e=Object(D.a)(C.a.mark(function e(t,n){var a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={id_project:t.id,csv_url:n},e.next=3,A(hn,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),getItemsOfProject:function(){var e=Object(D.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("".concat(hn,"?projectId=").concat(t.id));case 2:return n=e.sent,e.abrupt("return",n.map(vn));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),deleteItem:function(){var e=Object(D.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z("".concat(hn,"/").concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},En=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={csvUrl:""},n.onInputChange=function(e){return n.setState({csvUrl:e.target.value})},n.onImport=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.onStartImport(),e.prev=1,e.next=4,bn.importFromCsvUrl(n.props.project,n.state.csvUrl);case 4:t=e.sent,n.onImportCompleted(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n.onImportFailed();case 11:case"end":return e.stop()}},e,null,[[1,8]])})),n.onStartImport=function(){return n.setState({importing:!0,importCompleted:!1,importError:!1})},n.onImportCompleted=function(e){n.setState({importing:!1,importCompleted:!0,csvUrl:"",importedItemsCount:e.length}),n.props.onItemsImported()},n.onImportFailed=function(){return n.setState({importing:!1,importError:!0})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(M.a,null,r.a.createElement(S.a,{className:"header-row"},r.a.createElement(T.a,null,r.a.createElement("h3",null,"Import new items"))),this.state.importError&&r.a.createElement(kn,null),this.state.importCompleted&&r.a.createElement(gn,{count:this.state.importedItemsCount}),r.a.createElement(at.a,{className:"mb-3"},r.a.createElement(rt.a,{placeholder:"https://raw.githubusercontent.com/...","aria-label":"URL of CSV file",onChange:this.onInputChange,disabled:this.state.importing,name:"csvUrl"}),r.a.createElement(at.a.Append,null,r.a.createElement(te.a,{variant:"outline-primary",value:this.state.csvUrl,disabled:this.state.csvUrl.length<=0||this.state.importing,onClick:this.onImport},"Import"))),this.state.importing&&r.a.createElement(jn,null))}}]),t}(a.Component),kn=function(){return r.a.createElement(B.a,{variant:"danger"},"There's been an error while importing the items.")},gn=function(e){var t=e.count;return r.a.createElement(B.a,{variant:"success"},t," items imported successfully!")},jn=function(){return r.a.createElement(fn.a,{animated:!0,now:100})},yn=(n(405),function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,n=this.props.items,a=t.getColumnNames(n);return r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement(Z.a,{striped:!0,bordered:!0,hover:!0,className:"items-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),a.map(function(e){return r.a.createElement("th",{key:e},e)}),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,n.map(function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,t.id),a.map(function(e){return r.a.createElement("td",{key:"".concat(t.id,"-").concat(e)},t.data[e]||"")}),r.a.createElement("td",null,r.a.createElement(wn,{item:t,onDeleted:function(){return e.props.onItemDeleted(t)}})))})))))}}]),t}(a.Component));yn.getColumnNames=function(e){var t={};return e.map(function(e){return e.data}).map(Object.keys).forEach(function(e){return t[e]=!0}),Object.keys(t)};var wn=function(e){var t=e.item,n=e.onDeleted;return r.a.createElement(ne,{onDeleted:n,serviceCall:function(){return bn.deleteItem(t)},header:r.a.createElement(ee.a.Title,null,"Delete item ",r.a.createElement("span",{className:"project-id"},"#",t.id)),body:r.a.createElement("div",{className:"delete-item-table-container"},"Are you sure you want to following item?",r.a.createElement(Z.a,{striped:!0,bordered:!0,hover:!0,className:"delete-item-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Key"),r.a.createElement("th",null,"Value"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Id"),r.a.createElement("td",null,"item.id")),Object.keys(t.data).map(function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,e),r.a.createElement("td",null,t.data[e]))}))))})},On=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},n.componentDidMount=function(){return n.fetchItems()},n.componentWillUnmount=function(){return n.pendingItemsRequest.cancel()},n.fetchItems=Object(D.a)(C.a.mark(function e(){var t,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.props.project,n.pendingItemsRequest=q(bn.getItemsOfProject(t)),e.next=5,n.pendingItemsRequest.result;case 5:a=e.sent,n.setState({items:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n.setState({items:null,fetchError:!0});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),n.onItemDeleted=function(e){var t=n.state.items.indexOf(e),a=n.state.items;a.splice(t,1),n.setState({items:a})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.project;return r.a.createElement("div",null,r.a.createElement(En,{project:e,onItemsImported:this.fetchItems}),r.a.createElement(M.a,null,r.a.createElement(S.a,{className:"header-row"},r.a.createElement(T.a,null,r.a.createElement("h3",null,"Uploaded Items")))),r.a.createElement(M.a,{className:"items-table-container"},!this.state.items&&r.a.createElement(Cn,null),this.state.items&&r.a.createElement(yn,{items:this.state.items,onItemDeleted:this.onItemDeleted})))}}]),t}(a.Component),Cn=function(){return r.a.createElement(M.a,null,r.a.createElement("p",null,"Loading items ..."))},Dn=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},n.componentDidMount=function(){return n.fetchProject()},n.componentWillUnmount=function(){return n.pendingProjectRequest.cancel()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"fetchProject",value:function(){var e=Object(D.a)(C.a.mark(function e(){var t,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,this.pendingProjectRequest=q($.getProject(t)),e.next=5,this.pendingProjectRequest.result;case 5:n=e.sent,this.setState({project:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),Oe(this);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(M.a,null,r.a.createElement(x.a,null,r.a.createElement(Q,{to:Pn},"Projects"),r.a.createElement(X,null,this.state.project?this.state.project.data.name:"...")),!this.state.project&&r.a.createElement(Mn,null),this.state.project&&r.a.createElement(S.a,null,r.a.createElement(xn,{project:this.state.project}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("hr",null),r.a.createElement(ye.a,{defaultActiveKey:"workflow"},r.a.createElement(we.a,{eventKey:"workflow",title:"Workflows"},r.a.createElement(dn,{project:this.state.project})),r.a.createElement(we.a,{eventKey:"items",title:"Items"},r.a.createElement(On,{project:this.state.project}))))))}}]),t}(a.Component),Mn=function(){return r.a.createElement("p",null,"Fetching ...")};function xn(e){var t=e.project;return r.a.createElement(M.a,null,r.a.createElement(S.a,{className:"header-row"},r.a.createElement(T.a,null,r.a.createElement("h2",null,t.data.name)),r.a.createElement(T.a,{className:"d-flex flex-row-reverse"},r.a.createElement("div",null,r.a.createElement(N.a,{to:"".concat(Pn,"/").concat(t.id,"/edit"),className:"btn btn-primary"},"Edit")))),r.a.createElement(S.a,null,r.a.createElement(T.a,null,t.data.description)))}var Sn=n(69),Tn=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},n.componentDidMount=function(){return n.fetchProject()},n.fetchProject=Object(D.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.getProject(n.state.id);case 3:t=e.sent,n.setState({project:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Oe(Object(Sn.a)(Object(Sn.a)(n)));case 10:case"end":return e.stop()}},e,null,[[0,7]])})),n.handleProjectSubmission=function(){var e=Object(D.a)(C.a.mark(function e(t,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.setSubmitting)(!0),e.prev=2,e.next=5,$.updateProject({id:n.state.project.id,data:t});case 5:n.returnToProjectPage(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.onUpdateProjectFailed(e.t0);case 11:r(!1);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onCancel=function(){return n.returnToProjectPage()},n.returnToProjectPage=function(){return n.props.history.push("".concat(Pn,"/").concat(n.state.project.id))},n.onUpdateProjectFailed=function(e){return n.setState({updateError:e})},n.state={id:e.match.params.id},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(M.a,null,r.a.createElement(x.a,null,r.a.createElement(Q,{to:Pn},"Projects"),r.a.createElement(Q,{to:"".concat(Pn,"/").concat(this.props.match.params.id)},this.state.project?this.state.project.data.name:"..."),r.a.createElement(X,null,"Edit")),r.a.createElement(S.a,null,r.a.createElement(T.a,null,r.a.createElement("h4",null,"Edit project ",this.state.project&&this.state.project.data.name))),this.state.updateError&&r.a.createElement(Nn,{error:this.state.updateError}),!this.state.project&&r.a.createElement(Bn,null),this.state.project&&r.a.createElement(ke,{projectData:this.state.project.data,onSubmit:this.handleProjectSubmission,submitText:"Save",cancelText:"Back to Project",cancelButtonUrlDestination:"".concat(Pn,"/").concat(this.state.project.id)}))}}]),t}(a.Component);function Bn(){return r.a.createElement("p",null,"Fetching Project...")}var Nn=function(e){e.error;return r.a.createElement(T.a,null,r.a.createElement(B.a,{variant:"danger"},"There's been an updating the project."))},Pn="/projects",In=function(){return r.a.createElement(j.a,null,r.a.createElement(y.a,{path:"".concat(Pn),exact:!0,component:le}),r.a.createElement(y.a,{path:"".concat(Pn,"/new"),component:ge}),r.a.createElement(y.a,{path:"".concat(Pn,"/:id/edit"),exact:!0,component:Tn}),r.a.createElement(y.a,{path:"".concat(Pn,"/:id"),component:Dn}))},Wn=function(){return r.a.createElement(j.a,null,r.a.createElement(y.a,{path:"".concat(Pn),component:In}),r.a.createElement(y.a,{path:"".concat("/workflows"),component:cn}),r.a.createElement(y.a,{render:function(){return r.a.createElement(w.a,{to:"".concat(Pn)})}}))},Un=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sidebarOpen:!1},n.onToggleSidebar=function(){return n.setState(function(e){return{sidebarOpen:!e.sidebarOpen}})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement("div",{className:"wrapper"},r.a.createElement(v,{sidebarOpen:this.state.sidebarOpen}),r.a.createElement("div",{className:"content",style:{display:"flex",flexDirection:"column"}},r.a.createElement(g,{onToggleSidebar:this.onToggleSidebar}),r.a.createElement(Wn,null))))}}]),t}(a.Component),Vn=(n(408),n(198)),An=n.n(Vn);n(409),n(410),n(412);An.a.init({selector:"#tiny",plugins:["paste","link"]});var Fn=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(Un,null)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Fn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[201,1,2]]]);
//# sourceMappingURL=main.c75c2c8d.chunk.js.map