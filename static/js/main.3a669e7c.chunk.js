(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{117:function(e,t,n){"use strict";var a=n(92),r=n(0),o=n.n(r);n(440);t.a=function(e){var t=e.to,n=e.text;return o.a.createElement(a.a,{to:t,className:"btn btn-outline-primary back-button"},o.a.createElement("i",{className:"fas fa-arrow-left"})," ",n)}},14:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return p}),n.d(t,"d",function(){return h}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"c",function(){return E});var a=n(1),r=n.n(a),o=n(11),c=n(33);function i(e,t){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(r.a.mark(function e(t,n){var a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s(n),e.next=3,fetch(t,n);case 3:if(a=e.sent,d(a)){e.next=8;break}throw(o=new Error("HTTP response code not 200")).status=a.status,o;case 8:return e.next=10,a.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var s=function(e){return c.a.isInitialized()&&c.a.isSignedIn()?u(e):e},u=function(e){return(e=e||{}).headers=e.headers||{},e.headers.Authorization="Bearer ".concat(c.a.getBearerToken()),e},d=function(e){return e.status>=200&&e.status<=299};function p(e,t){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return(m=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(e){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t,{method:"DELETE"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function E(e){var t=!1;return{result:new Promise(function(n,a){e.then(function(e){t||n(e)}).catch(function(e){t||a(e)})}),cancel:function(){return t=!0}}}},18:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r});var a="https://trentocrowdai.github.io/crowdhub-web",r="https://crowdai-servant-api-dev.herokuapp.com"},22:function(e,t,n){"use strict";var a=n(241),r=n(0),o=n.n(r);t.a=function(e){var t=e.loading,n=e.children;return t?o.a.createElement("div",{className:"loading-spinner-container"},o.a.createElement(a.a,{animation:"border",variant:"primary"})):n}},237:function(e,t,n){e.exports=n.p+"static/media/menu.7d88ba55.svg"},242:function(e,t,n){e.exports=n(461)},247:function(e,t,n){},252:function(e,t,n){},253:function(e,t,n){},256:function(e,t,n){},281:function(e,t,n){},296:function(e,t,n){},297:function(e,t,n){},30:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(1),r=n.n(a),o=n(11),c=n(19),i=n(14),l=n(18),s="".concat(l.a,"/workflows"),u="invalid_workflow_data",d=function(e){var t=e.id,n=e.id_project,a=e.data;return Object(c.a)({id:t,projectId:parseInt(n)},a)},p=function(e){return{id:e.id,id_project:e.projectId,data:{name:e.name,description:e.description,graph:e.graph,shared:e.shared}}};t.b={getWorkflowsOfProject:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(s,"?projectId=").concat(t.id));case 2:return n=e.sent,e.abrupt("return",n.map(d));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(s,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",d(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=p(t),e.next=3,Object(i.d)(s,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),updateWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[WorkflowsSerivice] updateWorkflow()"),e.prev=1,n=p(t),console.info("[WorkflowService] updateWorkflow",n),e.next=6,Object(i.e)("".concat(s,"/").concat(t.id),n);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(1),400!==e.t0.response){e.next=15;break}throw new Error(u);case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),deleteWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.f)("".concat(s,"/").concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),saveAndStartWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[WorkflowsSerivice] saveAndStartWorkflow()"),e.next=3,this.updateWorkflow(t);case 3:return e.next=5,this.startWorkflow(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),startWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[WorkflowsSerivice] startWorkflow()"),e.next=3,Object(i.d)("".concat(s,"/").concat(t.id,"/start"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),estimateDoBlockCost:function(){var e=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.d)("".concat(s,"/").concat(t,"/").concat(n,"/estimated-cost"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}},300:function(e,t,n){},301:function(e,t,n){},302:function(e,t,n){},303:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},307:function(e,t,n){},308:function(e,t,n){},33:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(11),c={_authChangeListeners:[],auth2:null,init:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._waitForGapiToLoad();case 2:return e.next=4,this._loadAuth2Api();case 4:this.auth2=e.sent,this._notifyListeners();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),_waitForGapiToLoad:function(){return new Promise(function(e){var t=setInterval(function(){window.gapi&&(clearInterval(t),e())},100)})},_loadAuth2Api:function(){return new Promise(function(e){gapi.load("auth2",function(){var t=gapi.auth2.init();e(t)})})},addOnAuthChangeListener:function(e){this._authChangeListeners.push(e)},renderSignInButton:function(e,t){var n=this;this.assertInitialized(),gapi.signin2.render(e,{onSuccess:function(){t(),n._notifyListeners()}})},_notifyListeners:function(){this._authChangeListeners.forEach(function(e){return e()})},isInitialized:function(){return!!this.auth2},isSignedIn:function(){return this.assertInitialized(),this.auth2.isSignedIn.get()},signOut:function(){var e=this;return this.assertInitialized(),new Promise(function(t){return e.auth2.signOut().then(function(){t(),e._notifyListeners()})})},getBearerToken:function(){return this.assertInitialized(),this.auth2.currentUser.get().getAuthResponse().id_token},getUserInfo:function(){return this.assertInitialized(),this.auth2.currentUser.get().getBasicProfile()},assertInitialized:function(){if(!this.isInitialized())throw new Error("AuthService not initialized")}};t.a=c},34:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return i});var a=n(0),r=n.n(a),o=n(92),c=function(e){var t=e.to,n=e.children;return r.a.createElement("li",{className:"breadcrumb-item"},r.a.createElement(o.a,{to:t},n))},i=function(e){var t=e.children;return r.a.createElement("li",{className:"breadcrumb-item"},t)}},35:function(e,t,n){"use strict";var a=n(90),r=n(241),o=n(0),c=n.n(o);t.a=function(e){var t=e.isLoading,n=e.disabled,o=e.onClick,i=e.children,l=e.block,s=e.variant;return c.a.createElement(a.a,{disabled:n||t,onClick:o,className:l?"btn-block":"",variant:s||"primary"},t&&c.a.createElement(r.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),c.a.createElement("span",null," ",i))}},38:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(487),c=n(240),i=n(1),l=n.n(i),s=n(11),u=n(2),d=n(3),p=n(6),f=n(4),h=n(7),m=n(463),g=n(489),b=n(471),v=n(220),k=n(470),E=n(92),j=n(40),w=n(14),y=n(34),O=n(468),C=n(480),x=n(90),B=n(46),S=n(35),M=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShowModal=function(){return n.setState({show:!0})},n.onCloseModal=function(){return n.setState({show:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement(D,Object.assign({show:this.state.show,onCancel:this.onCloseModal},this.props)),r.a.createElement("a",{className:"icon-button delete",onClick:Object(B.a)(this.onShowModal)},r.a.createElement("i",{className:"fas fa-trash-alt"})))}}]),t}(a.Component),D=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={deleting:!1,deleteError:!1},n.onCancel=function(){return n.props.onCancel()},n.onConfirmDeletion=Object(s.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.onDeleting(),e.prev=1,e.next=4,n.props.serviceCall();case 4:n.onDeleted(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n.onDeleteError();case 10:case"end":return e.stop()}},e,null,[[1,7]])})),n.onDeleting=function(){return n.setState({deleting:!0,deleteError:!1})},n.onDeleteError=function(){return n.setState({deleting:!1,deleteError:!0})},n.onDeleted=function(){n.setState({deleting:!1,deleteError:!1}),n.props.onDeleted()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(C.a,{show:this.props.show},r.a.createElement(C.a.Header,null,this.props.header),r.a.createElement(C.a.Body,null,this.state.deleteError&&r.a.createElement(k.a,{variant:"danger"},"There's been an error with the deleting request."),this.props.body),r.a.createElement(C.a.Footer,null,r.a.createElement(x.a,{variant:"secondary",onClick:this.onCancel,disabled:this.state.deleting},"Cancel"),r.a.createElement(S.a,{variant:"danger",className:"confirm",onClick:this.onConfirmDeletion,isLoading:this.state.deleting},"Delete")))}}]),t}(a.Component),I=n(84),N=n(481),R=n(231),T=n(475),W=n(18),P="".concat(W.a,"/users"),A=function(e){var t=e.id,n=e.data;return{id:t,email:n.email,imageUrl:n.picture}},F=4,L={findUsersByEmail:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)("".concat(P,"?email=").concat(t));case 2:return n=e.sent,e.abrupt("return",n.map(A));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getById:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)("".concat(P,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",A(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},U=n(22),V="".concat(W.a,"/project-collaborations"),z=function(e){return{id:e.id,projectId:e.id_project,userId:e.id_user}},_={getCollaborationsOfProject:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)("".concat(V,"?projectId=").concat(t));case 2:return n=e.sent,e.abrupt("return",n.map(z));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createCollaboration:function(){var e=Object(s.a)(l.a.mark(function e(t,n){var a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:(o={projectId:t,userId:n}).id,projectId:o.projectId,userId:o.userId},e.next=3,Object(w.d)(V,a);case 3:return r=e.sent,e.abrupt("return",z(r));case 5:case"end":return e.stop()}var o},e)}));return function(t,n){return e.apply(this,arguments)}}(),deleteCollaboration:function(){var e=Object(s.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.f)("".concat(V,"/").concat(t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},G=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n.fetchSuggestions=function(){var e=Object(s.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>=F)){e.next=4;break}return e.next=3,n.fetchSuggestionsFromService(t);case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",[]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.fetchSuggestionsFromService=function(){var e=Object(s.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.findUsersByEmail(t);case 2:return a=e.sent,e.abrupt("return",n.filterUserAlreadyCollaborating(a));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.filterUserAlreadyCollaborating=function(e){var t=n.getUserIdsOfCollaborators();return e.filter(function(e){return n.props.project.ownerId!==e.id}).filter(function(e){return null==t.find(function(t){return t===e.id})})},n.getUserIdsOfCollaborators=function(){return n.getCollaborations().map(function(e){return e.userId})},n.getCollaborations=function(){return n.props.collaborations},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.project;return r.a.createElement("div",null,r.a.createElement("h4",null,"Add a new collaboration"),r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"User email"),r.a.createElement(H,{fetchSuggestions:this.fetchSuggestions,renderSuggestion:function(n){return r.a.createElement(q,Object.assign({key:n.id},n,{projectId:t.id,onCollaborationAdded:e.props.onCollaborationAdded}))},onSuggestionSelected:this.onAddUser})))}}]),t}(a.Component),q=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isAdding:!1,added:!1},n.onAddUser=Object(s.a)(l.a.mark(function e(){var t,a,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,a=t.projectId,r=t.id,n.setState({isAdding:!0}),e.prev=2,e.next=5,_.createCollaboration(a,r);case 5:o=e.sent,n.props.onCollaborationAdded(o),n.setState({added:!0}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:n.setState({isAdding:!1});case 13:case"end":return e.stop()}},e,null,[[2,10]])})),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.isAdding,n=e.added,a=this.props,o=a.email,c=a.imageUrl;return r.a.createElement(R.a,{className:"collaborator-row"},r.a.createElement(b.a,null,r.a.createElement(v.a,{xs:2},r.a.createElement("img",{alt:"user avatar",className:"user-avatar",src:c})),r.a.createElement(v.a,{xs:7},o),r.a.createElement(v.a,{xs:3,className:"action"},n?r.a.createElement(x.a,{className:"btn-block",disabled:!0,variant:"success"},"Added"):r.a.createElement(S.a,{block:!0,isLoading:t,onClick:this.onAddUser},"Add"))))}}]),t}(a.Component),H=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).DEFAULT_TIMEOUT=300,n.timeout=null,n.state={suggestions:[],isFetching:!1,value:""},n.onInputChange=function(e){n.setState({value:e}),n.isTimeoutRunning()&&n.cancelTimeout(),n.startTimeout(e)},n.isTimeoutRunning=function(){return null!==n.timeout},n.cancelTimeout=function(){clearTimeout(n.timeout),n.timeout=null},n.startTimeout=function(e){return n.timeout=setTimeout(function(){return n.onTimeoutElapsed(e)},n.DEFAULT_TIMEOUT)},n.onTimeoutElapsed=function(){var e=Object(s.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isFetching:!0}),e.prev=1,e.next=4,n.props.fetchSuggestions(t);case 4:a=e.sent,n.setState({suggestions:a,isFetching:!1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),n.onSuggestionSelected=function(e){n.isTimeoutRunning()&&n.cancelTimeout(),n.setState({value:"",suggestions:[],isFetching:!1}),n.props.onSuggestionSelected(e)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.value,a=t.suggestions,o=t.isFetching,c=t.fetchError,i=this.props.renderSuggestion;return r.a.createElement("div",null,r.a.createElement(N.a.Control,{className:"mb-2",value:n,onChange:function(t){return e.onInputChange(t.target.value)}}),r.a.createElement(U.a,{loading:o},c&&r.a.createElement("span",null,"Can't suggest users"),r.a.createElement(T.a,null,!c&&a.map(i))))}}]),t}(a.Component),J=function(e){var t=e.collaborations,n=e.onCollaborationDeleted;return r.a.createElement("div",null,r.a.createElement("h4",null,"Collaborations"),r.a.createElement(T.a,null,t.length<=0&&r.a.createElement("span",null,"No collaborations"),t.length>0&&t.map(function(e){return r.a.createElement(K,Object.assign({key:e.id},e,{onCollaborationDeleted:n}))})))},K=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isFetching:!1,user:null,isRemoving:!1},n.componentDidMount=function(){return n.fetchUser()},n.fetchUser=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isFetching:!0}),e.prev=1,e.next=4,L.getById(n.getUserId());case 4:t=e.sent,n.setState({user:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:n.setState({isFetching:!1});case 12:case"end":return e.stop()}},e,null,[[1,8]])})),n.getUserId=function(){return n.props.userId},n.onRemoveUser=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isRemoving:!0}),e.prev=1,t=n.getCollaborationId(),e.next=5,_.deleteCollaboration(t);case 5:n.props.onCollaborationDeleted(t),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:n.setState({isRemoving:!1});case 11:case"end":return e.stop()}},e,null,[[1,8]])})),n.getCollaborationId=function(){return n.props.id},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.isRemoving,n=e.isFetching,a=e.user||{},o=a.email,c=a.imageUrl;return r.a.createElement(R.a,{className:"collaborator-row"},r.a.createElement(U.a,{loading:n},r.a.createElement(b.a,null,r.a.createElement(v.a,{xs:2},r.a.createElement("img",{alt:"user avatar",className:"user-avatar",src:c})),r.a.createElement(v.a,{xs:7},o),r.a.createElement(v.a,{xs:3,className:"action"},r.a.createElement(S.a,{isLoading:t,onClick:this.onRemoveUser,variant:"danger"},"Remove")))))}}]),t}(a.Component),Y=(n(307),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShowModal=function(){return n.setState({show:!0})},n.onCloseModal=function(){return n.setState({show:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement($,Object.assign({show:this.state.show,onClose:this.onCloseModal},this.props)),r.a.createElement("a",{className:"icon-button",onClick:Object(B.a)(this.onShowModal)},r.a.createElement("i",{className:"fas fa-share-alt"})))}}]),t}(a.Component)),$=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={collaborations:null,isFetching:!1,fetchError:!1},n.componentDidMount=function(){return n.fetchCollaborations()},n.fetchCollaborations=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({collaborations:null,isFetching:!0,fetchError:!1}),e.prev=1,e.next=4,_.getCollaborationsOfProject(n.getProject().id);case 4:t=e.sent,n.setState({collaborations:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n.setState({fetchError:!0});case 11:n.setState({isFetching:!1});case 12:case"end":return e.stop()}},e,null,[[1,8]])})),n.getProject=function(){return n.props.project},n.onClose=function(){return n.props.onClose()},n.onCollaborationAdded=function(e){return n.setState({collaborations:[].concat(Object(I.a)(n.state.collaborations),[e])})},n.onCollaborationDeleted=function(e){var t=n.state.collaborations,a=t.findIndex(function(t){return t.id===e});a>=0&&(t.splice(a,1),n.setState({collaborations:t}))},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.fetchError,n=e.collaborations,a=e.isFetching,o=this.getProject();return r.a.createElement(C.a,{show:this.props.show},r.a.createElement(C.a.Header,null,"Sharing preferences of project #",o.id),r.a.createElement(C.a.Body,null,r.a.createElement(U.a,{loading:a},t&&r.a.createElement(k.a,{variant:"danger"},"An error occurred while fetching the sharing preferences."),r.a.createElement(G,{collaborations:n,project:o,onCollaborationAdded:this.onCollaborationAdded}),r.a.createElement(J,{collaborations:n,onCollaborationDeleted:this.onCollaborationDeleted}))),r.a.createElement(C.a.Footer,null,r.a.createElement(x.a,{onClick:this.onClose},"Close")))}}]),t}(a.Component),Q=(n(308),function(e){var t=e.projects,n=e.onProjectDeleted;return r.a.createElement(v.a,null,r.a.createElement(O.a,{hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement(X,{project:e,key:e.id,onProjectDeleted:n})}))))}),X=function(e){var t=e.project,n=e.onProjectDeleted,a="".concat(Ze,"/").concat(t.id);return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(E.a,{to:a},t.id)),r.a.createElement("td",null,r.a.createElement(E.a,{to:a},t.data.name)),r.a.createElement("td",null,t.data.description),r.a.createElement("td",{className:"actions-cell"},r.a.createElement(Y,{project:t}),r.a.createElement(Z,{project:t}),r.a.createElement(ee,{project:t,onProjectDeleted:n})))},Z=function(e){var t=e.project,n="".concat(Ze,"/").concat(t.id,"/edit");return r.a.createElement(E.a,{to:n,className:"icon-button"},r.a.createElement("i",{className:"fas fa-edit"}))},ee=function(e){var t=e.project,n=e.onProjectDeleted;return r.a.createElement(M,{onDeleted:n,serviceCall:function(){return j.a.deleteProject(t)},header:r.a.createElement(C.a.Title,null,"Delete project ",r.a.createElement("span",{className:"project-id"},"#",t.id)),body:r.a.createElement("div",null,"Are you sure you want to delete the project ",r.a.createElement("strong",null,t.data.name),"?")})},te=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n.componentDidMount=function(){return n.fetchProjects()},n.componentWillUnmount=function(){return n.pendingProjectsRequest.cancel()},n.fetchProjects=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.pendingProjectsRequest=Object(w.c)(j.a.getProjects()),e.next=4,n.pendingProjectsRequest.result;case 4:t=e.sent,n.setState({projects:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.setState({projects:null,fetchError:!0});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(g.a,null,r.a.createElement(y.b,null,"Projects")),r.a.createElement(b.a,{className:"header-row"},r.a.createElement(v.a,null,r.a.createElement("h3",null,"Projects list")),r.a.createElement(v.a,{className:"d-flex flex-row-reverse"},r.a.createElement(E.a,{className:"btn btn-primary",to:"".concat(Ze,"/new")},"New"))),r.a.createElement(U.a,{loading:!this.state.projects&&!this.state.fetchError},r.a.createElement(b.a,null,!this.state.projects&&this.state.fetchError&&r.a.createElement(ae,null),this.state.projects&&0===this.state.projects.length&&r.a.createElement(ne,null),this.state.projects&&this.state.projects.length>0&&r.a.createElement(Q,{projects:this.state.projects,onProjectDeleted:this.fetchProjects}))))}}]),t}(a.Component),ne=function(){return r.a.createElement(v.a,null,r.a.createElement("p",null,"You haven't created any project yet. Use the 'Add' button to create a new one"))},ae=function(){return r.a.createElement(v.a,null,r.a.createElement(m.a,null,r.a.createElement(k.a,{variant:"danger"},"There's been an error while fetching the projects")))},re=n(123),oe=n(61),ce=(n(439),n(235)),ie=n.n(ce),le=n(236),se=n.n(le),ue=n(117),de=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n.handleSubmit=function(e,t){var a=n.valuesToProjectData(e);n.props.onSubmit(a,t)},n.valuesToProjectData=function(e){return{name:e.name,description:e.description}},n.projectDataToValues=function(e){var t=e||{};return{name:t.name||"",description:t.description||""}},n.validationSchema=oe.object().shape({name:oe.string().required("Name is required"),description:oe.string().required("Description is required")}),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"project-form-container"},r.a.createElement(re.a,{initialValues:this.projectDataToValues(this.props.projectData),onSubmit:this.handleSubmit,validationSchema:this.validationSchema},function(t){var n=t.handleSubmit,a=t.handleChange,o=t.handleBlur,c=t.values,i=t.touched,l=t.errors,s=function(e){return i[e]&&!l[e]},u=function(e){return i[e]&&l[e]};return r.a.createElement(N.a,{onSubmit:n,noValidate:!0},r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"Project name"),r.a.createElement(N.a.Control,{name:"name",type:"text",value:c.name,onChange:a,onBlur:o,placeholder:"Ex: classify category of papers",isInvalid:u("name"),isValid:s("name")}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},l.name)))),r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"Project description"),r.a.createElement(N.a.Control,{name:"description",value:c.description,as:"textarea",rows:"3",onChange:a,onBlur:o,isInvalid:u("description"),isValid:s("description")}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},l.description)))),r.a.createElement(ie.a,{className:"form-buttons"},r.a.createElement(ue.a,{to:e.props.cancelButtonUrlDestination||"/",text:e.props.cancelText}),r.a.createElement(se.a,{variant:"primary",type:"submit",className:"submit-project-form"},e.props.submitText)))}))}}]),t}(a.Component),pe=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={creationError:!1},n.handleProjectSubmission=function(){var e=Object(s.a)(l.a.mark(function e(t,a){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.setSubmitting)(!0),e.prev=2,e.next=5,j.a.createProject(t);case 5:n.redirectToProjectsList(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.onProjectCreationFailed();case 11:r(!1);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onProjectCreationFailed=function(){return n.setState({creationError:!0})},n.redirectToProjectsList=function(){return n.props.history.push(Ze)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(g.a,null,r.a.createElement(y.a,{to:Ze},"Projects"),r.a.createElement(y.b,null,"New")),r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement("h1",null,"Create new project"))),this.state.creationError&&r.a.createElement(fe,null),r.a.createElement(de,{cancelButtonUrlDestination:Ze,cancelText:"Back to Projects",onSubmit:this.handleProjectSubmission,submitText:"Create"}))}}]),t}(a.Component),fe=function(){return r.a.createElement(v.a,null,r.a.createElement(k.a,{variant:"danger"},"There's been an error while creating the project"))},he=n(482),me=n(476),ge=n(81),be=n(30),ve=n(19),ke=(n(444),n(472)),Ee=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).validationSchema=oe.object().shape({name:oe.string().required("Name is required"),description:oe.string().required("Description is required")}),n.handleSubmit=function(){var e=Object(s.a)(l.a.mark(function e(t,a){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.valuesToWorkflow(t),e.next=3,n.props.onSubmit(r,a);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.workflowToValues=function(e){var t=e||{};return{name:t.name||"",description:t.description||""}},n.valuesToWorkflow=function(e){return{name:e.name,description:e.description}},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(re.a,{initialValues:this.workflowToValues(this.props.workflow),onSubmit:this.handleSubmit,validationSchema:this.validationSchema},function(t){var n=t.handleSubmit,a=t.handleChange,o=t.handleBlur,c=t.values,i=t.touched,l=t.errors,s=function(e){return i[e]&&!l[e]},u=function(e){return i[e]&&l[e]};return r.a.createElement(N.a,{onSubmit:n,noValidate:!0},r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"Workflow name name"),r.a.createElement(N.a.Control,{name:"name",type:"text",value:c.name,onChange:a,onBlur:o,isInvalid:u("name"),isValid:s("name")}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},l.name)))),r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"Workflow description"),r.a.createElement(N.a.Control,{name:"description",value:c.description,as:"textarea",rows:"3",onChange:a,onBlur:o,isInvalid:u("description"),isValid:s("description")}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},l.description)))),r.a.createElement(ke.a,{className:"form-buttons"},r.a.createElement(x.a,{variant:"secondary",onClick:e.props.onCancel},"Cancel"),r.a.createElement(x.a,{type:"submit"},"Create")))})}}]),t}(a.Component),je=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={showModal:!1},n.showCreateWorkflowModal=function(){return n.setState({showModal:!0})},n.onWorkflowCreated=function(){n.hideCreateWorkflowModal(),n.props.onWorkflowCreated()},n.hideCreateWorkflowModal=function(){return n.setState({showModal:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(we,{show:this.state.showModal,onCancel:this.hideCreateWorkflowModal,projectId:this.props.projectId,onWorkflowCreated:this.onWorkflowCreated}),r.a.createElement(x.a,{onClick:this.showCreateWorkflowModal},"Add workflow"))}}]),t}(a.Component),we=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={creationError:!1},n.createNewWorkflow=function(){var e=Object(s.a)(l.a.mark(function e(t,a){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.setSubmitting)(!0),e.prev=2,e.next=5,be.b.createWorkflow(Object(ve.a)({},t,{projectId:n.props.projectId}));case 5:n.onWorkflowCreated(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.onWorkflowCreationError();case 11:r(!1);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onWorkflowCreated=function(){return n.props.onWorkflowCreated()},n.onWorkflowCreationError=function(){return n.setState({creationError:!0})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(C.a,{show:this.props.show},r.a.createElement(C.a.Header,null,r.a.createElement(C.a.Title,null,"Create new workflow")),r.a.createElement(C.a.Body,null,this.state.creationError&&r.a.createElement(ye,null),r.a.createElement(Ee,{onCancel:this.props.onCancel,onSubmit:this.createNewWorkflow})))}}]),t}(a.Component),ye=function(){return r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement(k.a,{variant:"danger"},"There's been an error while creating the new workflow.")))},Oe=n(47),Ce=(n(445),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShowModal=function(){return n.setState({show:!0})},n.onCloseModal=function(){return n.setState({show:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement(xe,Object.assign({show:this.state.show,onClose:this.onCloseModal},this.props)),r.a.createElement("a",{className:"icon-button",onClick:Object(B.a)(this.onShowModal)},r.a.createElement("i",{className:"fas fa-share-alt"})))}}]),t}(a.Component)),xe=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={workflow:null,isFetching:!1,fetchError:!1,isSaving:!1,saveError:!1},n.fetchWorkflow=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.setState({isFetching:!0,fetchError:!1}),e.next=4,be.b.getWorkflow(n.getWorkflowId());case 4:t=e.sent,n.setState({isFetching:!1,fetchError:!1,workflow:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.setState({isFetching:!1,fetchError:!0});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),n.getWorkflowId=function(){return n.props.workflow.id},n.shareWorkflow=function(){return n.setState({workflow:Object(ve.a)({},n.state.workflow,{shared:!0})})},n.unshareWorkflow=function(){return n.setState({workflow:Object(ve.a)({},n.state.workflow,{shared:!1})})},n.onCancel=function(){return n.props.onClose()},n.onSave=Object(s.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.setState({isSaving:!0,saveError:!1}),e.next=4,be.b.updateWorkflow(n.state.workflow);case 4:n.setState({isSaving:!1,saveError:!1}),n.props.onWorkflowSharedOrUnshared(),n.props.onClose(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n.setState({isSaving:!1,saveError:!0});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){this.props.show&&!e.show&&this.fetchWorkflow()}},{key:"render",value:function(){var e=this.state,t=e.isFetching,n=e.fetchError,a=e.isSaving,o=e.saveError,c=e.workflow;return r.a.createElement(C.a,{show:this.props.show},r.a.createElement(C.a.Header,null,"Sharing preferences of workflow #",this.getWorkflowId()),r.a.createElement(C.a.Body,null,r.a.createElement(U.a,{loading:t},n&&r.a.createElement(k.a,{variant:"danger"},"An error occurred while fetching the sharing preferences."),o&&r.a.createElement(k.a,{variant:"danger"},"An error occurred while saving the sharing preferences."),c&&r.a.createElement(Be,{workflowId:c.id,shared:!!c.shared,shareWorkflow:this.shareWorkflow,unshareWorkflow:this.unshareWorkflow}))),r.a.createElement(C.a.Footer,null,r.a.createElement(x.a,{variant:"secondary",onClick:this.onCancel,disabled:a},"Cancel"),r.a.createElement(S.a,{onClick:this.onSave,disabled:t,isLoading:a},"Save")))}}]),t}(a.Component),Be=function(e){var t=e.shared,n=e.workflowId,a=e.shareWorkflow,o=e.unshareWorkflow,c=Se(n);return r.a.createElement("div",null,r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Check,{checked:!t,type:"radio",label:"Private Workflow",onChange:o}),r.a.createElement("p",{className:"description-of-radio"},"Workflow visible and editable only by the owner and collaborators")),r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Check,{checked:t,type:"radio",label:"Public Workflow",onChange:a}),r.a.createElement("p",{className:"description-of-radio"},"Workflow visible by anyone and editable only by the owner and collaborators. Public Link: ",r.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},c))))},Se=function(e){return"".concat(W.b,"/#").concat(Oe.a,"/").concat(e)},Me=(n(446),function(e){var t=e.workflows,n=(e.onWorkflowUpdated,e.onWorkflowDeleted),a=e.onWorkflowSharedOrUnshared;return r.a.createElement(O.a,{hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement(De,{workflow:e,key:e.id,onWorkflowDeleted:n,onWorkflowSharedOrUnshared:a})})))}),De=function(e){var t=e.workflow,n=e.onWorkflowDeleted,a=e.onWorkflowSharedOrUnshared,o="".concat(Oe.c,"/").concat(t.id);return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(E.a,{to:o},t.id)),r.a.createElement("td",null,r.a.createElement(E.a,{to:o},t.name),r.a.createElement("i",{className:"share-status-icon fas ".concat(t.shared?"fa-unlock":"fa-lock")})),r.a.createElement("td",null,t.description),r.a.createElement("td",null,r.a.createElement(Ce,{workflow:t,onWorkflowSharedOrUnshared:a}),r.a.createElement(Ie,{workflow:t,onWorkflowDeleted:n})))},Ie=function(e){var t=e.workflow,n=e.onWorkflowDeleted;return r.a.createElement(M,{onDeleted:n,serviceCall:function(){return be.b.deleteWorkflow(t)},header:r.a.createElement(C.a.Title,null,"Delete worflow ",r.a.createElement("span",{className:"project-id"},t.name)),body:r.a.createElement("div",null,'Are you sure you want to delete "',r.a.createElement("strong",null,t.name),'"?')})},Ne=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){return n.fetchWorkflows()},n.componentWillUnmount=function(){return n.pendingWorkflowsRequest.cancel()},n.fetchWorkflows=Object(s.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({workflows:null}),e.prev=1,t=be.b.getWorkflowsOfProject(n.props.project),n.pendingWorkflowsRequest=Object(w.c)(t),e.next=6,n.pendingWorkflowsRequest.result;case 6:a=e.sent,n.setState({workflows:a}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.setState({workflows:null,fetchError:!0});case 13:case"end":return e.stop()}},e,null,[[1,10]])})),n.onWorkflowCreated=function(){return n.fetchWorkflows()},n.state={projectId:e.project.id,workflows:null,fetchError:!1},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(b.a,{className:"header-row"},r.a.createElement(v.a,null,r.a.createElement("h3",null,"Workflows")),r.a.createElement(v.a,{className:"d-flex flex-row-reverse"},r.a.createElement("div",null,r.a.createElement(je,{projectId:this.state.projectId,onWorkflowCreated:this.onWorkflowCreated})))),r.a.createElement(U.a,{loading:!this.state.workflows&&!this.state.fetchError},r.a.createElement(b.a,null,r.a.createElement(v.a,null,this.state.fetchError&&r.a.createElement(Re,null),this.state.workflows&&r.a.createElement(Me,{workflows:this.state.workflows,onWorkflowDeleted:this.fetchWorkflows,onWorkflowSharedOrUnshared:this.fetchWorkflows})))))}}]),t}(a.Component),Re=function(){return r.a.createElement(v.a,null,r.a.createElement(m.a,null,r.a.createElement(k.a,{variant:"danger"},"There's been an error while fetching the workflows of the project")))},Te=n(469),We=n(219),Pe=n(474),Ae="".concat(W.a,"/items");function Fe(e){return e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e.deleted_ad=new Date(e.deleted_ad),e}var Le={importFromCsvUrl:function(){var e=Object(s.a)(l.a.mark(function e(t,n){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={id_project:t.id,csv_url:n},e.next=3,Object(w.d)(Ae,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),getItemsOfProject:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)("".concat(Ae,"?projectId=").concat(t.id));case 2:return n=e.sent,e.abrupt("return",n.map(Fe));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),deleteItem:function(){var e=Object(s.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.f)("".concat(Ae,"/").concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ue=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={csvUrl:""},n.onInputChange=function(e){return n.setState({csvUrl:e.target.value})},n.onImport=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.onStartImport(),e.prev=1,e.next=4,Le.importFromCsvUrl(n.props.project,n.state.csvUrl);case 4:t=e.sent,n.onImportCompleted(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n.onImportFailed();case 11:case"end":return e.stop()}},e,null,[[1,8]])})),n.onStartImport=function(){return n.setState({importing:!0,importCompleted:!1,importError:!1})},n.onImportCompleted=function(e){n.setState({importing:!1,importCompleted:!0,csvUrl:"",importedItemsCount:e.length}),n.props.onItemsImported()},n.onImportFailed=function(){return n.setState({importing:!1,importError:!0})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(b.a,{className:"header-row"},r.a.createElement(v.a,null,r.a.createElement("h3",null,"Import new items"))),this.state.importError&&r.a.createElement(Ve,null),this.state.importCompleted&&r.a.createElement(ze,{count:this.state.importedItemsCount}),r.a.createElement(Te.a,{className:"mb-3"},r.a.createElement(We.a,{placeholder:"https://raw.githubusercontent.com/...","aria-label":"URL of CSV file",onChange:this.onInputChange,disabled:this.state.importing,name:"csvUrl"}),r.a.createElement(Te.a.Append,null,r.a.createElement(x.a,{variant:"outline-primary",value:this.state.csvUrl,disabled:this.state.csvUrl.length<=0||this.state.importing,onClick:this.onImport},"Import"))),this.state.importing&&r.a.createElement(_e,null))}}]),t}(a.Component),Ve=function(){return r.a.createElement(k.a,{variant:"danger"},"There's been an error while importing the items.")},ze=function(e){var t=e.count;return r.a.createElement(k.a,{variant:"success"},t," items imported successfully!")},_e=function(){return r.a.createElement(Pe.a,{animated:!0,now:100})},Ge=(n(447),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,n=this.props.items,a=t.getColumnNames(n);return r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement(O.a,{striped:!0,bordered:!0,hover:!0,className:"items-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Id"),a.map(function(e){return r.a.createElement("th",{key:e},e)}),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,n.map(function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,t.id),a.map(function(e){return r.a.createElement("td",{key:"".concat(t.id,"-").concat(e)},t.data[e]||"")}),r.a.createElement("td",null,r.a.createElement(qe,{item:t,onDeleted:function(){return e.props.onItemDeleted(t)}})))})))))}}]),t}(a.Component));Ge.getColumnNames=function(e){var t={};return e.map(function(e){return e.data}).map(Object.keys).forEach(function(e){return e.forEach(function(e){return t[e]=!0})}),Object.keys(t)};var qe=function(e){var t=e.item,n=e.onDeleted;return r.a.createElement(M,{onDeleted:n,serviceCall:function(){return Le.deleteItem(t)},header:r.a.createElement(C.a.Title,null,"Delete item ",r.a.createElement("span",{className:"project-id"},"#",t.id)),body:r.a.createElement("div",{className:"delete-item-table-container"},"Are you sure you want to following item?",r.a.createElement(O.a,{striped:!0,bordered:!0,hover:!0,className:"delete-item-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Key"),r.a.createElement("th",null,"Value"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Id"),r.a.createElement("td",null,"item.id")),Object.keys(t.data).map(function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,e),r.a.createElement("td",null,t.data[e]))}))))})},He=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n.componentDidMount=function(){return n.fetchItems()},n.componentWillUnmount=function(){return n.pendingItemsRequest.cancel()},n.fetchItems=Object(s.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.props.project,n.pendingItemsRequest=Object(w.c)(Le.getItemsOfProject(t)),e.next=5,n.pendingItemsRequest.result;case 5:a=e.sent,n.setState({items:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n.setState({items:null,fetchError:!0});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),n.onItemDeleted=function(e){var t=n.state.items.indexOf(e),a=n.state.items;a.splice(t,1),n.setState({items:a})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.project;return r.a.createElement("div",null,r.a.createElement(Ue,{project:e,onItemsImported:this.fetchItems}),r.a.createElement(m.a,null,r.a.createElement(b.a,{className:"header-row"},r.a.createElement(v.a,null,r.a.createElement("h3",null,"Uploaded Items")))),r.a.createElement(U.a,{loading:!this.state.items},r.a.createElement(m.a,{className:"items-table-container"},r.a.createElement(Ge,{items:this.state.items,onItemDeleted:this.onItemDeleted}))))}}]),t}(a.Component),Je=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n.componentDidMount=function(){return n.fetchProject()},n.componentWillUnmount=function(){return n.pendingProjectRequest.cancel()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"fetchProject",value:function(){var e=Object(s.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,this.pendingProjectRequest=Object(w.c)(j.a.getProject(t)),e.next=5,this.pendingProjectRequest.result;case 5:n=e.sent,this.setState({project:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),Object(ge.a)(this);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(g.a,null,r.a.createElement(y.a,{to:Ze},"Projects"),r.a.createElement(y.b,null,this.state.project?this.state.project.data.name:"...")),r.a.createElement(U.a,{loading:!this.state.project},r.a.createElement(b.a,null,r.a.createElement(Ke,{project:this.state.project}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("hr",null),r.a.createElement(he.a,{defaultActiveKey:"workflow"},r.a.createElement(me.a,{eventKey:"workflow",title:"Workflows"},r.a.createElement(Ne,{project:this.state.project})),r.a.createElement(me.a,{eventKey:"items",title:"Items"},r.a.createElement(He,{project:this.state.project})))))))}}]),t}(a.Component);function Ke(e){var t=e.project;return r.a.createElement(m.a,null,r.a.createElement(b.a,{className:"header-row"},r.a.createElement(v.a,null,r.a.createElement("h2",null,t.data.name)),r.a.createElement(v.a,{className:"d-flex flex-row-reverse"},r.a.createElement("div",null,r.a.createElement(E.a,{to:"".concat(Ze,"/").concat(t.id,"/edit"),className:"btn btn-primary"},"Edit")))),r.a.createElement(b.a,null,r.a.createElement(v.a,null,t.data.description)))}var Ye=n(23),$e=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){return n.fetchProject()},n.fetchProject=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.getProject(n.state.id);case 3:t=e.sent,n.setState({project:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object(ge.a)(Object(Ye.a)(Object(Ye.a)(n)));case 10:case"end":return e.stop()}},e,null,[[0,7]])})),n.handleProjectSubmission=function(){var e=Object(s.a)(l.a.mark(function e(t,a){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.setSubmitting)(!0),e.prev=2,e.next=5,j.a.updateProject({id:n.state.project.id,data:t});case 5:n.returnToProjectPage(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.onUpdateProjectFailed(e.t0);case 11:r(!1);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onCancel=function(){return n.returnToProjectPage()},n.returnToProjectPage=function(){return n.props.history.push("".concat(Ze,"/").concat(n.state.project.id))},n.onUpdateProjectFailed=function(e){return n.setState({updateError:e})},n.state={id:e.match.params.id},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(g.a,null,r.a.createElement(y.a,{to:Ze},"Projects"),r.a.createElement(y.a,{to:"".concat(Ze,"/").concat(this.props.match.params.id)},this.state.project?this.state.project.data.name:"..."),r.a.createElement(y.b,null,"Edit")),r.a.createElement(b.a,null,r.a.createElement(v.a,null,r.a.createElement("h4",null,"Edit project ",this.state.project&&this.state.project.data.name))),this.state.updateError&&r.a.createElement(Xe,{error:this.state.updateError}),!this.state.project&&r.a.createElement(Qe,null),this.state.project&&r.a.createElement(de,{projectData:this.state.project.data,onSubmit:this.handleProjectSubmission,submitText:"Save",cancelText:"Back to Project",cancelButtonUrlDestination:"".concat(Ze,"/").concat(this.state.project.id)}))}}]),t}(a.Component);function Qe(){return r.a.createElement("p",null,"Fetching Project...")}var Xe=function(e){e.error;return r.a.createElement(v.a,null,r.a.createElement(k.a,{variant:"danger"},"There's been an updating the project."))};n.d(t,"a",function(){return Ze}),n.d(t,"b",function(){return et});var Ze="/projects",et=function(){return r.a.createElement(o.a,null,r.a.createElement(c.a,{path:"".concat(Ze),exact:!0,component:te}),r.a.createElement(c.a,{path:"".concat(Ze,"/new"),component:pe}),r.a.createElement(c.a,{path:"".concat(Ze,"/:id/edit"),exact:!0,component:$e}),r.a.createElement(c.a,{path:"".concat(Ze,"/:id"),component:Je}))}},40:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(11),c=n(14),i=n(18),l="".concat(i.a,"/projects"),s={INVALID_WORKFLOW_DATA:"invalid_project_data"};function u(e){return e.id=parseInt(e.id),e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e.deleted_ad=new Date(e.deleted_ad),e.ownerId=e.id_user,e}function d(e){return e}t.a={getProjects:function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.a)(l);case 2:return t=e.sent,e.abrupt("return",t.map(u));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),getProject:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.a)("".concat(l,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",u(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createProject:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=d(t),e.next=3,Object(c.d)("".concat(l),n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),updateProject:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=d(t),e.next=4,Object(c.e)("".concat(l,"/").concat(t.id),n);case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(0),400!==e.t0.response){e.next=13;break}throw new Error(s.INVALID_PROJECT_DATA);case 13:throw e.t0;case 14:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),deleteProject:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.f)("".concat(l,"/").concat(t.id));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},439:function(e,t,n){},440:function(e,t,n){},444:function(e,t,n){},445:function(e,t,n){},446:function(e,t,n){},447:function(e,t,n){},450:function(e,t,n){},451:function(e,t,n){},452:function(e,t,n){},453:function(e,t,n){},454:function(e,t,n){},455:function(e,t,n){},46:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=function(e){return function(t){t.stopPropagation(),e()}}},461:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(24),c=n.n(o),i=(n(247),n(2)),l=n(3),s=n(6),u=n(4),d=n(7),p=n(486),f=(n(248),n(249),n(1)),h=n.n(f),m=n(11),g=n(479),b=(n(252),n(58)),v=n(47),k=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={runs:null},n.componentDidMount=function(){return n.fetchRuns()},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"fetchRuns",value:function(){var e=Object(m.a)(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.getRuns();case 3:t=e.sent,this.setState({runs:t}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("nav",{id:"sidebar",className:this.props.sidebarOpen?"open":""},r.a.createElement("h2",{className:"app-title"},"Servant"),r.a.createElement("ul",{className:"sidebar-list"},r.a.createElement("li",null,r.a.createElement(g.a,{to:"/projects"},"Projects")),r.a.createElement("li",null,r.a.createElement(E,{runs:this.state.runs})),r.a.createElement("li",null,r.a.createElement(j,{runs:this.state.runs}))))}}]),t}(a.Component),E=function(e){var t=e.runs;return t?r.a.createElement("div",null,"Latest finished runs",r.a.createElement(w,{runs:t.getFinishedRuns().slice(0,5)})):r.a.createElement("p",null,"Fetching latest finished runs ...")},j=function(e){var t=e.runs;return t?r.a.createElement("div",null,"Running runs",r.a.createElement(w,{runs:t.getRunningRuns().slice(0,5)})):r.a.createElement("p",null,"Fetching running runs ...")},w=function(e){var t=e.runs;return r.a.createElement("ul",null,t.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(g.a,{to:"".concat(v.c,"/").concat(e.getWorkflowId())},"#",e.id))}))},y=n(237),O=n.n(y),C=n(483),x=n(477),B=n(485),S=(n(453),n(14)),M=n(18),D="".concat(M.a,"/account-balance"),I=function(e){return e},N={_cachedBalance:null,getBalances:function(){var e=Object(m.a)(h.a.mark(function e(){var t,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isBalancesCached()){e.next=2;break}return e.abrupt("return",this._getCachedBalance());case 2:return e.next=4,Object(S.a)(D);case 4:return t=e.sent,n=I(t),this._cacheBalances(n),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),_isBalancesCached:function(){return!!this._getCachedBalance()},_getCachedBalance:function(){return this._cachedBalance},_cacheBalances:function(e){this._cachedBalance=e}},R=n(22),T=n(33),W=n(35),P=n(83),A=n(465),F=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(x.a,{placement:"bottom",trigger:"click",overlay:r.a.createElement(B.a,{id:"account-information-popover",title:"Account information"},r.a.createElement(U,null))},r.a.createElement("div",null,r.a.createElement(L,null)))}}]),t}(a.Component),L=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=T.a.getUserInfo();return r.a.createElement("div",null,r.a.createElement("span",null,e.getName()),r.a.createElement("img",{className:"user-avatar",src:e.getImageUrl(),alt:"user avatar"}))}}]),t}(a.Component),U=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(V,null),r.a.createElement("hr",null),r.a.createElement(z,null))}}]),t}(a.Component),V=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={balances:null,fetchError:!1},n.componentDidMount=Object(m.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchBalances();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),n.componentWillUnmount=function(){return n.pendingBalancesRequest.cancel()},n.fetchBalances=Object(m.a)(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({balances:null,fetchError:!1}),e.prev=1,n.pendingBalancesRequest=Object(S.c)(N.getBalances()),e.next=5,n.pendingBalancesRequest.result;case 5:t=e.sent,n.setState({balances:t,fetchError:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setState({balances:null,fetchError:!0});case 12:case"end":return e.stop()}},e,null,[[1,9]])})),n.renderBalances=function(){var e=n.state.balances,a=e.tolokaSandbox,o=e.tolokaNormal,c=e.f8;return r.a.createElement("div",null,r.a.createElement("strong",null,"Toloka Sandbox"),": ",t.prepareNumber(a),"$",r.a.createElement("br",null),r.a.createElement("strong",null,"Toloka"),": ",t.prepareNumber(o),"$",r.a.createElement("br",null),r.a.createElement("strong",null,"Toloka"),": ",t.prepareNumber(c),"$",r.a.createElement("br",null))},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"balances-container"},r.a.createElement("h6",null,"Balances"),r.a.createElement(R.a,{loading:!this.state.balances&&!this.state.fetchError},!this.state.balances&&this.state.fetchError&&r.a.createElement("p",null,"Error"),this.state.balances&&!this.state.fetchError&&this.renderBalances()))}}]),t}(a.Component);V.prepareNumber=function(e){return"number"===typeof e?e.toFixed(2):"not available"};var z=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={loggingOut:!1,loggedOut:!1},n.onLogout=Object(m.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loggingOut:!0}),e.prev=1,e.next=4,T.a.signOut();case 4:n.setState({loggedOut:!0}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:n.setState({loggingOut:!1});case 11:case"end":return e.stop()}},e,null,[[1,7]])})),n.renderRedirect=function(){return r.a.createElement(A.a,{to:P.a})},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.loggedOut?this.renderRedirect():r.a.createElement(W.a,{isLoading:this.state.loggingOut,onClick:this.onLogout,block:!0},"Logout")}}]),t}(a.Component),_=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(C.a,{className:"light-background",expand:"lg"},r.a.createElement("div",{className:"mr-auto"},r.a.createElement("button",{className:"navbar-toggle button-link",onClick:this.props.onToggleSidebar},r.a.createElement("img",{src:O.a,className:"menu-icon",alt:"Toggle sidebar"}))),r.a.createElement("div",null,r.a.createElement(F,null)))}}]),t}(a.Component),G=n(487),q=n(240),H=n(38),J=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={authServiceInitialized:!1},n.componentDidMount=function(){return n.initAuthService()},n.initAuthService=Object(m.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.init();case 2:n.setState({authServiceInitialized:!0});case 3:case"end":return e.stop()}},e)})),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.authServiceInitialized?this.renderRouter():this.renderInitializingAuthService()}},{key:"renderInitializingAuthService",value:function(){return r.a.createElement("div",{style:{height:"100vh"}},r.a.createElement(R.a,{loading:!0}))}},{key:"renderRouter",value:function(){return r.a.createElement(K,null)}}]),t}(a.Component),K=function(){return r.a.createElement(G.a,null,r.a.createElement(Y,{path:H.a,component:H.b}),r.a.createElement(Y,{path:v.c,component:v.d}),r.a.createElement($,{path:P.a,component:P.b}),r.a.createElement(q.a,{path:v.a,component:v.b}),r.a.createElement(q.a,{path:"/semplice",component:function(){return r.a.createElement("p",null,"ok")}}),r.a.createElement(q.a,{render:function(){return r.a.createElement(A.a,{to:H.a})}}))},Y=function(e){var t=e.path,n=e.component;return r.a.createElement(q.a,{path:t,render:function(){return T.a.isSignedIn()?r.a.createElement(n,null):r.a.createElement(A.a,{to:P.a})}})},$=function(e){var t=e.path,n=e.component;return r.a.createElement(q.a,{path:t,render:function(){return T.a.isSignedIn()?r.a.createElement(A.a,{to:H.a}):r.a.createElement(n,null)}})},Q=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sidebarOpen:!1},n.onToggleSidebar=function(){return n.setState(function(e){return{sidebarOpen:!e.sidebarOpen}})},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;T.a.addOnAuthChangeListener(function(){return e.forceUpdate()})}},{key:"render",value:function(){var e=T.a.isInitialized()&&T.a.isSignedIn();return r.a.createElement(p.a,null,r.a.createElement("div",{className:"wrapper"},e&&r.a.createElement(k,{sidebarOpen:this.state.sidebarOpen}),r.a.createElement("div",{className:"content",style:{display:"flex",flexDirection:"column"}},e&&r.a.createElement(_,{onToggleSidebar:this.onToggleSidebar}),r.a.createElement(J,null))))}}]),t}(a.Component),X=(n(455),n(238)),Z=n.n(X);n(456),n(457),n(459);Z.a.init({selector:"#tiny",plugins:["paste","link"]});var ee=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(Q,null)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},47:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(487),c=n(240),i=n(1),l=n.n(i),s=n(11),u=n(2),d=n(3),p=n(6),f=n(4),h=n(7),m=n(30),g=n(14),b=n(18),v="".concat(b.a,"/block-types"),k=function(e){var t=e.id,n=e.data;return{id:t,name:n.name,displayName:n.displayName,ports:n.ports,color:n.color,parameterDefinitions:n.parameterDefinitions}},E={getBlockTypeDefinitions:function(){var e=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)(v);case 2:return t=e.sent,e.abrupt("return",t.map(k));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},j=n(463),w=n(471),y=n(220),O=(n(253),n(470)),C=n(26),x=(n(255),n(256),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"generateLinkSegment",value:function(e,t,n,a){return r.a.createElement("path",{className:n?t.bem("--path-selected"):"",strokeWidth:e.width,stroke:"black",d:a})}}]),t}(C.DefaultLinkFactory)),B=n(19),S=n(84),M=n(44),D=n(23),I=n(108),N=n(481),R=function(){function e(t,n){Object(u.a)(this,e),this.deSerialize(t,n)}return Object(d.a)(e,[{key:"deSerialize",value:function(e,t){this.definition=e,this.blockModel=t;var n=t.getInitialParametersMap();this.setValue(n[this.getName()]),void 0===this.getValue()&&this.setValue(this.getDefinition().default)}},{key:"serialize",value:function(){return this.getValue()}},{key:"isValid",value:function(){return!1}},{key:"isRequired",value:function(){return this.getDefinition().required}},{key:"getDefinition",value:function(){return this.definition}},{key:"getName",value:function(){return this.getDefinition().name}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e}},{key:"shouldDisplay",value:function(){return!this.isOptional()||this.isConditionMet()}},{key:"isOptional",value:function(){return!!this.getCondition()}},{key:"isConditionMet",value:function(){var e=this.getCondition();return!!this.blockModel.getParameterModelsMap()[e].getValue()}},{key:"getCondition",value:function(){return this.getDefinition().condition}}]),e}(),T=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){if(this.getDefinition().required){var e=this.getValue();return e&&e.length>0}return!0}}]),t}(R),W={type:"text",Widget:function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onChange=function(e){var t=e.target.value;n.getModel().setValue(t),n.setState({value:t})},n.onBlur=function(){return n.props.onModelUpdated()},n.componentWillUnmount=n.onBlur,n.state={value:n.getModel().getValue()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),r.a.createElement(N.a.Control,{type:"text",value:this.state.value,onChange:this.onChange,onBlur:this.onBlur,isInvalid:!e.isValid(),disabled:this.props.disabled}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},t.displayName," is required"))}}]),t}(a.Component),Model:T},P={type:"number",Model:function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){var e=this.getValue();return!this.isRequired()||"number"===typeof e&&!isNaN(e)}}]),t}(R),Widget:function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onChange=function(e){var t=e.target.value;n.getModel().setValue(parseInt(t)),n.setState({value:t})},n.onBlur=function(){return n.props.onModelUpdated()},n.componentWillUnmount=n.onBlur,n.state={value:n.getModel().getValue()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),r.a.createElement(N.a.Control,{type:"number",value:"".concat(this.state.value),onChange:this.onChange,onBlur:this.onBlur,isInvalid:!e.isValid(),disabled:this.props.disabled}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},t.displayName," is required"))}}]),t}(a.Component)},A={type:"boolean",Model:function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){return!0}}]),t}(R),Widget:function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onChange=function(e){var t=e.target.checked;n.getModel().setValue(t),n.setState({value:t},n.props.onModelUpdated)},n.state={value:n.getModel().getValue()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel().getDefinition();return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},e.description),r.a.createElement(N.a.Check,{type:"checkbox",label:e.displayName,checked:this.state.value,onChange:this.onChange,disabled:this.props.disabled}))}}]),t}(a.Component)},F=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){var e=this.getValue();return null!==this.getChoices().find(function(t){return t.value===e})}},{key:"getChoices",value:function(){return this.getDefinition().choices}}]),t}(R),L={type:"textFromDropdown",Widget:function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onChangeValue=function(e){var t=e.target.value;n.getModel().setValue(t),n.props.onModelUpdated()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),r.a.createElement(N.a.Control,{as:"select",value:e.getValue(),onChange:this.onChangeValue,disabled:this.props.disabled},e.getChoices().map(function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)})))}}]),t}(a.Component),Model:F},U=n(82),V=n(90),z=n(480),_=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.showModal=function(){return n.setState({show:!0})},n.hideModal=function(){return n.setState({show:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(V.a,{disabled:this.props.disabled,className:"btn-block",onClick:this.showModal},"Open editor"),r.a.createElement(z.a,{show:this.state.show,size:"lg"},r.a.createElement(z.a.Header,null,this.props.title),r.a.createElement(z.a.Body,null,r.a.createElement(U.a,this.props)),r.a.createElement(z.a.Footer,null,r.a.createElement(V.a,{onClick:this.hideModal},"Close"))))}}]),t}(a.Component),G=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){return!0}}]),t}(R),q={type:"html",Widget:function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleEditorChange=function(e){n.getModel().setValue(e),n.props.onModelUpdated()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition(),n=this.getEditor();return r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),r.a.createElement(n,{onEditorChange:this.handleEditorChange,initialValue:e.getValue(),init:{menubar:!1},disabled:this.props.disabled,title:t.displayName}))}},{key:"getEditor",value:function(){return this.getModel().getDefinition().editorInModal?_:U.a}}]),t}(a.Component),Model:G},H=n(468),J=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){return this.getChoices().length>0}},{key:"getChoices",value:function(){return this.getValue()}},{key:"setChoices",value:function(e){this.setValue(e)}},{key:"removeChoiceByIndex",value:function(e){this.getChoices().splice(e,1)}},{key:"addChoice",value:function(e){this.getChoices().push(e)}}]),t}(R),K=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onRemoveChoice=function(e){n.getModel().removeChoiceByIndex(e),n.props.onModelUpdated()},n.onAddChoice=function(e){n.getModel().addChoice(e),n.props.onModelUpdated()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),r.a.createElement(Y,{choices:e.getChoices(),onRemoveChoice:this.onRemoveChoice}),r.a.createElement($,{onAddChoice:this.onAddChoice}))}}]),t}(a.Component),Y=function(e){var t=e.choices,n=e.onRemoveChoice;return r.a.createElement(H.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Label"),r.a.createElement("th",null,"Value"),r.a.createElement("th",null))),r.a.createElement("tbody",null,t.map(function(e,t){return r.a.createElement("tr",{key:e.value},r.a.createElement("td",null,e.label),r.a.createElement("td",null,e.value),r.a.createElement("td",null,r.a.createElement("button",{className:"icon-button button-link",onClick:function(){return n(t)}},r.a.createElement("i",{className:"fas fa-trash-alt"}))))})))},$=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={label:"",value:""},n.isNewChoiceValid=function(){return n.state.label.length>0&&n.state.value.length>0},n.onAddChoice=function(){n.props.onAddChoice({label:n.state.label,value:n.state.value}),n.setState({label:"",value:""})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(N.a.Row,null,r.a.createElement(y.a,{md:"12",lg:"6"},r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"Label"),r.a.createElement(N.a.Control,{name:"label",type:"text",value:this.state.label,onChange:function(t){return e.setState({label:t.target.value})}}))),r.a.createElement(y.a,{md:"12",lg:"6"},r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,null,"Value"),r.a.createElement(N.a.Control,{name:"value",type:"text",value:this.state.value,onChange:function(t){return e.setState({value:t.target.value})}}))),r.a.createElement(y.a,{md:"12",className:""},r.a.createElement(V.a,{onClick:this.onAddChoice,disabled:!this.isNewChoiceValid()},"Add")))}}]),t}(a.Component),Q={type:"choiceBuilder",Widget:K,Model:J},X=n(222),Z=n.n(X),ee=(n(278),n(280),n(469)),te=n(219),ne=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",content:null},n.onChange=function(e){var t=e.target.files;1===t.length&&n.onPickFile(t[0])},n.onPickFile=function(){var e=Object(s.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.t1=t.name,e.next=4,n.readFileContent(t);case 4:e.t2=e.sent,e.t3={name:e.t1,content:e.t2},e.t0.setState.call(e.t0,e.t3);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.readFileContent=function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise(function(e,a){n.addEventListener("load",function(t){return e(t.target.result)}),n.readAsText(t)}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onImport=function(){return n.props.onFilePicked(n.state.content)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h5",null,"Import from file"),r.a.createElement(ee.a,null,r.a.createElement(ee.a.Prepend,null,r.a.createElement("label",{className:"btn btn-primary"},"Select file",r.a.createElement("input",{type:"file",style:{display:"none"},accept:".js",multiple:!1,onChange:this.onChange}))),r.a.createElement(te.a,{value:this.state.name,placeholder:"Click the left button or drop a file",readOnly:!0}),r.a.createElement(ee.a.Append,null,r.a.createElement(V.a,{style:{height:"24px",boxSizing:"content-box"},disabled:null===this.state.content,onClick:this.onImport},"Import"))))}}]),t}(a.Component),ae=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.showModal=function(){return n.setState({show:!0})},n.hideModal=function(){return n.setState({show:!1})},n.onSave=function(e){n.props.onUpdateCode(e),n.hideModal()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(V.a,{className:"btn-block",onClick:this.showModal,disabled:this.props.disabled},"Open editor"),r.a.createElement(re,{show:this.state.show,onClose:this.hideModal,onSave:this.onSave,code:this.props.code}))}}]),t}(a.Component),re=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onCodeEdited=function(e){return n.setState({code:e})},n.onSave=function(){return n.props.onSave(n.state.code)},n.state={code:n.props.code},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(z.a,{show:this.props.show,size:"lg"},r.a.createElement(z.a.Header,null,"Lambda block code editor"),r.a.createElement(z.a.Body,null,r.a.createElement(ne,{onFilePicked:this.onCodeEdited}),r.a.createElement("hr",null),r.a.createElement(oe,{code:this.state.code,onCodeEdited:this.onCodeEdited})),r.a.createElement(z.a.Footer,null,r.a.createElement(V.a,{variant:"secondary",onClick:this.props.onClose},"Cancel"),r.a.createElement(V.a,{onClick:this.onSave},"Save")))}}]),t}(a.Component),oe=function(e){var t=e.onCodeEdited,n=e.code;return r.a.createElement("div",null,r.a.createElement("h5",null,"Editor"),r.a.createElement(Z.a,{style:{width:"100%"},placeholder:"Lambda block code",mode:"javascript",theme:"monokai",name:"lambdaBlockCodeEditor",onChange:t,fontSize:14,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,value:n,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2}}))},ce=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){return!0}},{key:"getCode",value:function(){return this.getValue()}},{key:"setCode",value:function(e){this.setValue(e)}}]),t}(R),ie={type:"code",Widget:function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onUpdateCode=function(e){n.getModel().setCode(e),n.props.onModelUpdated()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),r.a.createElement(ae,{code:e.getCode(),onUpdateCode:this.onUpdateCode,disabled:this.props.disabled}))}}]),t}(a.Component),Model:ce},le=n(484),se=(n(281),function(){return de({r:ue(),g:ue(),b:ue()})}),ue=function(){return Math.floor(Math.random()*Math.floor(256))},de=function(e){var t=e.r,n=e.g,a=e.b;return"#".concat(((1<<24)+(t<<16)+(n<<8)+a).toString(16).slice(1))},pe=function(e){return!!fe(e)},fe=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},he=function(e){return ge(me(fe(e)))},me=function(e){return(.299*e.r+.587*e.g+.114*e.b)/255},ge=function(e){return e>.5?"black":"white"},be=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).setBlockingContextId=function(e){return n.setValue(e)},n.getBlockingContextId=function(){return n.getValue()},n.isBlockingContextSelected=function(){return!!n.getBlockingContextId()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){return!0}}]),t}(R),ve=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).getBlockingContextsModel=function(){return n.getModel().blockModel.getBlockingContexts()},n.getBlockingContextName=function(e){return n.getBlockingContextsModel().getBlockingContextById(e).name},n.onBlockingContextSelected=function(e){var t=e.id;n.getModel().setBlockingContextId(t),n.props.onModelUpdated()},n.isDisabled=function(){return n.props.disabled},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel().getDefinition(),t=this.getBlockingContextsModel();return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},e.description),r.a.createElement(le.a,null,this.renderToggle(),r.a.createElement(ke,{contexts:t.getContexts(),onContextSelected:this.onBlockingContextSelected})))}},{key:"renderToggle",value:function(){var e=this.getModel();if(!e.isBlockingContextSelected())return r.a.createElement(le.a.Toggle,{disabled:this.isDisabled(),className:"btn-block"},"None");var t=this.getBlockingContextsModel().getBlockingContextById(e.getBlockingContextId());return r.a.createElement(le.a.Toggle,{disabled:this.isDisabled(),className:"btn-block",style:{backgroundColor:t.color,border:t.color,color:he(t.color)}},t.name)}}]),t}(a.Component),ke=function(e){var t=e.contexts,n=e.onContextSelected;return r.a.createElement(le.a.Menu,null,r.a.createElement(le.a.Item,{onClick:function(){return n({id:null})},className:"blocking-context-drop-down-item"},r.a.createElement("div",{className:"blocking-context-color-box"}),"None"),t.map(function(e){return r.a.createElement(le.a.Item,{key:e.id,className:"blocking-context-drop-down-item",onClick:function(){return n(e)}},r.a.createElement("div",{className:"blocking-context-color-box",style:{backgroundColor:e.color}}),e.name)}))},Ee={type:"blockingContext",Model:be,Widget:ve},je=n(35),we=function(e){var t={};return e.forEach(function(e){return t[e.type]=e}),t}([W,P,A,L,q,Q,ie,Ee,{type:"doBlockCost",Widget:function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).estimateCost=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({estimatedCost:null,estimationError:!1,estimating:!0}),e.prev=1,e.next=4,m.b.estimateDoBlockCost(n.getWorkflowId(),n.getBlockId());case 4:t=e.sent,n.onCostEstimated(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n.setState({estimatedCost:null,estimationError:!0,estimating:!1});case 11:case"end":return e.stop()}},e,null,[[1,8]])})),n.state={estimatedCost:n.getModel().getEstimatedCost(),estimationError:!1,estimating:!1},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"getWorkflowId",value:function(){return this.getBlockModel().parent.workflowId}},{key:"getBlockModel",value:function(){return this.getModel().blockModel}},{key:"getBlockId",value:function(){return this.getBlockModel().id}},{key:"onCostEstimated",value:function(e){this.setState({estimatedCost:e,estimationError:!1,estimating:!1}),this.getModel().setEstimatedCost(e)}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderEstimatedCost(),r.a.createElement(je.a,{block:!0,onClick:this.estimateCost,isLoading:this.state.estimating,disabled:this.props.disabled},"Estimate cost"))}},{key:"renderEstimatedCost",value:function(){return null===this.state.estimatedCost?this.renderCostNeverEstimated():this.renderLatestEstimatedCost()}},{key:"renderCostNeverEstimated",value:function(){return r.a.createElement(N.a.Text,{className:"text-muted"},"The cost of this block has never been estimated. Click the button below to estimate it.")}},{key:"renderLatestEstimatedCost",value:function(){return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},"The latest estimated cost is: ",r.a.createElement("strong",null,this.state.estimatedCost,"$"),". Click the button below to estimate it again."))}}]),t}(a.Component),Model:function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"isValid",value:function(){return!0}},{key:"setEstimatedCost",value:function(e){e&&(e=e.toFixed(2)),this.setValue(e)}},{key:"getEstimatedCost",value:function(){return this.getValue()}}]),t}(R)}]),ye=n(225),Oe=n.n(ye),Ce=(n(295),n(488)),xe=function(e){var t=e.componentsContainerRef,n=e.designBlockTypeDefinitions;return r.a.createElement("div",null,r.a.createElement("h5",null,"Design blocks"),r.a.createElement("div",{ref:t},n.map(function(e){return r.a.createElement(Ce.a,{key:e.name,"data-block-type-definition":JSON.stringify(e),className:"mb-2"},r.a.createElement(Ce.a.Header,null,e.displayName))})))},Be=n(226),Se=(n(296),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={expanded:!1},n.toggleExpansion=function(){return n.setState(function(e){return{expanded:!e.expanded}})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(Ce.a,{className:"block-card"},r.a.createElement(Ce.a.Header,null,r.a.createElement("div",{onClick:this.toggleExpansion},r.a.createElement("div",null,this.props.invalid&&r.a.createElement("i",{className:"fas fa-exclamation-triangle"}),this.props.title),r.a.createElement("i",{className:"fas fa-caret-down ".concat(this.state.expanded?"expanded":"collapsed")}))),r.a.createElement(Be.a,{in:this.state.expanded},r.a.createElement("div",null,r.a.createElement(Ce.a.Body,null,this.props.children))))}}]),t}(a.Component)),Me=(n(297),function(e){var t=e.parametrizedBlock,n=e.onParameterModelUpdate,a=e.disabled,o=e.parametersInCard,c=t.getId(),i=t.getParameterModelsMap(),l=t.getParameterDefinitionList();return r.a.createElement("div",null,l.map(function(e){var t=tt[e.type],l="".concat(c,"-").concat(e.name),s=i[e.name];if(!s.shouldDisplay())return null;if(t){var u=t.Widget;return r.a.createElement(De,{inCard:o,title:s.getDefinition().displayName,key:l},r.a.createElement(u,{model:s,onModelUpdated:n,disabled:a}))}return r.a.createElement(Re,{key:l,parameter:e})}))}),De=function(e){var t=e.inCard,n=e.title,a=e.children;return t?r.a.createElement(Ie,{title:n,children:a}):r.a.createElement(Ne,{title:n,children:a})},Ie=function(e){var t=e.title,n=e.children;return r.a.createElement(Ce.a,{className:"right-sidebar-parameter"},r.a.createElement(Ce.a.Header,null,t),r.a.createElement(Ce.a.Body,null,n))},Ne=function(e){var t=e.title,n=e.children;return r.a.createElement("div",{className:"parameter-container-line-separator"},r.a.createElement("h6",null,t),n)},Re=function(e){var t=e.parameter;return r.a.createElement(O.a,{variant:"danger"},"Error: Unknown parameter '",t.name,"' of type '",t.type,"'.")},Te=function(e){var t=e.componentsContainerRef,n=e.designBlocksModel,a=e.onParameterModelUpdate;return r.a.createElement("div",null,r.a.createElement("h5",null,"Your job design"),r.a.createElement("div",{ref:t,style:{minHeight:"100px"}},n.getBlockModels().map(function(e){return r.a.createElement(We,{designBlockTypeDefinitions:n.getDesignBlockTypeDefinitions(),key:e.getId(),designBlockModel:e,onParameterModelUpdate:a})})))},We=function(e){var t=e.designBlockModel,n=e.onParameterModelUpdate;return r.a.createElement("div",{"data-block-id":t.getId()},r.a.createElement(Se,{title:t.getDesignBlockTypeDefinition().displayName,invalid:!t.isValid()},r.a.createElement(Me,{parametrizedBlock:t,onParameterModelUpdate:n})))},Pe=n(67),Ae=n.n(Pe),Fe=function(){function e(t,n){var a=this;Object(u.a)(this,e),this.isValid=function(){return null==Object.values(a.getParameterModelsMap()).find(function(e){return!e.isValid()})},this.deSerialize(t,n)}return Object(d.a)(e,[{key:"deSerialize",value:function(t,n){this.setDesignBlockTypeDefinition(t),n=e.initializeBlockIfNeeded(n,t),this.id=n.id,this.type=n.type,this.initialParametersMap=n.parameters,this.setParameterModelsMap(nt(this,t.parameterDefinitions))}},{key:"setDesignBlockTypeDefinition",value:function(e){this.designBlockTypeDefinition=e}},{key:"getDesignBlockTypeDefinition",value:function(){return this.designBlockTypeDefinition}},{key:"serialize",value:function(){return{id:this.id,type:this.type,parameters:at(this.getParameterModelsMap())}}},{key:"getId",value:function(){return this.id}},{key:"getParameterModelsMap",value:function(){return this.parameterModelsMap}},{key:"setParameterModelsMap",value:function(e){this.parameterModelsMap=e}},{key:"getParameterDefinitionList",value:function(){return this.getDesignBlockTypeDefinition().parameterDefinitions}},{key:"getInitialParametersMap",value:function(){return this.initialParametersMap}}],[{key:"initializeBlockIfNeeded",value:function(e,t){return(e=e||{}).id=e.id||Ae()(),e.type=e.type||t.name,e.parameters=e.parameters||{},e}}]),e}(),Le=function(e,t){for(var n=0;n<t.children.length;n++)if(t.children[n]===e)return n;return-1},Ue=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).blockTypesRef=null,n.blocksRef=null,n.drake=null,n.componentDidMount=function(){return n.setupDragula()},n.setupDragula=function(){var e=n.blockTypesRef.current,t=n.blocksRef.current,a=[e,t];n.drake=Oe()(a,{copy:function(t,n){return n===e},accepts:function(e,n){return n===t},removeOnSpill:!0}),n.drake.on("drop",function(a,r,o,c){if(r===t){var i=Le(c,t);o===e?n.onBlockAdded(a,i):n.onBlockSorted(a,i)}}),n.drake.on("remove",function(e,t){t.appendChild(e);var a=e.getAttribute("data-block-id");n.getModel().removeBlockById(a),n.props.onModelUpdated()})},n.onBlockAdded=function(e,t){n.assertNextSiblingIndexIsValidGivenInitialBlocks(t);var a=n.getNewBlockIndexGivenNextSiblingIndex(t),r=n.buildNewBlockDataGivenClonedElement(e);n.addBlockDataToTheDesignAndNotify(r,a),e.parentNode.removeChild(e)},n.assertNextSiblingIndexIsValidGivenInitialBlocks=function(e){if(0===e||e>n.getBlockModels().length)throw new Error("invalid nextSiblingIndex given the current blocks array")},n.getNewBlockIndexGivenNextSiblingIndex=function(e){return-1===e?n.getBlockModels().length:e-1},n.buildNewBlockDataGivenClonedElement=function(e){var t=JSON.parse(e.getAttribute("data-block-type-definition"));return new Fe(t)},n.addBlockDataToTheDesignAndNotify=function(e,t){n.getModel().addBlock(e,t),n.forceUpdate()},n.onBlockSorted=function(e,t){n.assertNextSiblingIndexIsValidGivenInitialBlocks(t);var a=n.getMovedBlockIndex(e),r=n.getBlockIndexGivenNextSiblingIndex(t);n.getModel().swapBlocks(a,r),n.props.onModelUpdated()},n.getMovedBlockIndex=function(e){var t=n.getModel().getBlocks(),a=e.getAttribute("data-block-id");return t.findIndex(function(e){return e.id===a})},n.getBlockIndexGivenNextSiblingIndex=function(e){return-1===e?n.getBlockModels().length-1:e-1},n.blockTypesRef=r.a.createRef(),n.blocksRef=r.a.createRef(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.designBlocksModel}},{key:"getBlockModels",value:function(){return this.getModel().getBlockModels()}},{key:"render",value:function(){return r.a.createElement(w.a,null,r.a.createElement(y.a,{md:"6",lg:"4"},r.a.createElement(xe,{designBlockTypeDefinitions:this.getModel().getDesignBlockTypeDefinitions(),componentsContainerRef:this.blockTypesRef})),r.a.createElement(y.a,{md:"6",lg:"8"},r.a.createElement(Te,{componentsContainerRef:this.blocksRef,designBlocksModel:this.getModel(),onParameterModelUpdate:this.props.onModelUpdated})))}}]),t}(a.Component),Ve=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={show:!1},n.showModal=function(){return n.setState({show:!0})},n.hideModal=function(){return n.setState({show:!1})},n.onSave=function(){n.getModel().setBlocksModel(n.designBlocksClonedModel),n.props.onModelUpdated(),n.hideModal()},n.designBlocksClonedModel=n.cloneDesignBlocksModel(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){this.props.templateJustPicked&&(this.designBlocksClonedModel=this.cloneDesignBlocksModel(),this.props.onModelUpdated())}},{key:"getModel",value:function(){return this.props.designModel}},{key:"cloneDesignBlocksModel",value:function(){return this.getModel().getBlocksModel().clone()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(ze,{show:this.state.show,designBlocksModel:this.designBlocksClonedModel,onClose:this.hideModal,onSave:this.onSave}),r.a.createElement(V.a,{className:"btn-block",onClick:this.showModal,disabled:this.props.disabled},this.props.buttonText))}}]),t}(a.Component),ze=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.designBlocksModel,a=t.onSave,o=t.onClose;return r.a.createElement(z.a,{show:this.props.show,size:"lg"},r.a.createElement(z.a.Header,null,"Do block design editor"),r.a.createElement(z.a.Body,null,r.a.createElement(Ue,{designBlocksModel:n,onModelUpdated:function(){e.forceUpdate()}})),r.a.createElement(z.a.Footer,null,r.a.createElement(V.a,{variant:"secondary",onClick:o},"Cancel"),r.a.createElement(V.a,{onClick:a,disabled:!n.isValid()},"Save")))}}]),t}(a.Component),_e=function(){function e(t,n){Object(u.a)(this,e),this.deSerialize(t,n)}return Object(d.a)(e,[{key:"deSerialize",value:function(e,t){var n=this;this.setDesignBlockTypeDefinitions(e),this.setBlockModels(t.map(function(e){return new Fe(n.getDesignBlockTypeDefinition(e.type),e)}))}},{key:"setDesignBlockTypeDefinitions",value:function(e){this.designBlockTypeDefinitions=e}},{key:"getDesignBlockTypeDefinition",value:function(e){return this.getDesignBlockTypeDefinitions().find(function(t){return t.name===e})}},{key:"getDesignBlockTypeDefinitions",value:function(){return this.designBlockTypeDefinitions}},{key:"getBlockModels",value:function(){return this.blockModels}},{key:"setBlockModels",value:function(e){this.blockModels=e}},{key:"clone",value:function(){return new e(this.getDesignBlockTypeDefinitions(),this.serialize())}},{key:"serialize",value:function(){return this.getBlockModels().map(function(e){return e.serialize()})}},{key:"isDesignEmpty",value:function(){return 0===this.getBlockModels().length}},{key:"addBlock",value:function(e,t){this.getBlockModels().splice(t,0,e)}},{key:"swapBlocks",value:function(e,t){var n=this.getBlockModels(),a=n[e];n[e]=n[t],n[t]=a}},{key:"removeBlockById",value:function(e){var t=this.getBlockModels(),n=t.findIndex(function(t){return t.id===e});n>=0&&t.splice(n,1)}},{key:"isValid",value:function(){return null==this.getBlockModels().find(function(e){return!e.isValid()})}}]),e}(),Ge=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"deSerialize",value:function(e,n){Object(M.a)(Object(f.a)(t.prototype),"deSerialize",this).call(this,e,n),this.setBlocksModel(new _e(e.designBlockTypeDefinitions,this.getDesign().blocks))}},{key:"serialize",value:function(){return{blocks:this.getBlocksModel().serialize()}}},{key:"getDesign",value:function(){return this.getValue()}},{key:"getBlocksModel",value:function(){return this.blocksModel}},{key:"setBlocksModel",value:function(e){this.blocksModel=e}},{key:"isValid",value:function(){return this.getBlocksModel().isValid()}},{key:"isDesignEmpty",value:function(){return this.getBlocksModel().isDesignEmpty()}}]),t}(R),qe="".concat(b.a,"/template-do"),He=function(e){var t=e.id,n=e.data;return Object(B.a)({id:t},n)},Je={getDoDesignTemplates:function(){var e=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)(qe);case 2:return t=e.sent,e.abrupt("return",t.map(He));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},Ke=150,Ye=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShow=function(){return n.setState({show:!0})},n.onHide=function(e){return n.setState({show:!1},function(){return setTimeout(e,Ke)})},n.onDesignBlocksModelPicked=function(e){return n.onHide(function(){n.getDesignModel().setBlocksModel(e),n.props.onModelUpdated()})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getDesignBlockTypeDefinitions",value:function(){return this.getDesignModel().getBlocksModel().getDesignBlockTypeDefinitions()}},{key:"getDesignModel",value:function(){return this.props.designModel}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement($e,{show:this.state.show,onHide:this.onHide,onDesignBlocksModelPicked:this.onDesignBlocksModelPicked,designBlockTypeDefinitions:this.getDesignBlockTypeDefinitions()}),r.a.createElement(V.a,{variant:"success",onClick:this.onShow,className:"btn-block mb-2",disabled:this.props.disabled},"Create from a template"))}}]),t}(a.Component),$e=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={templates:null,fetchError:!1},n.componentDidMount=function(){return n.fetchTemplates()},n.componentWillUnmount=function(){return n.pendingTemplatesRequest.cancel()},n.fetchTemplates=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({fetchError:!1}),e.prev=1,n.pendingTemplatesRequest=Object(g.c)(Je.getDoDesignTemplates()),e.next=5,n.pendingTemplatesRequest.result;case 5:t=e.sent,n.setState({templates:t}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setState({fetchError:!0});case 12:case"end":return e.stop()}},e,null,[[1,9]])})),n.onTemplatePicked=function(e){var t=new _e(n.props.designBlockTypeDefinitions,e.blocks);n.props.onDesignBlocksModelPicked(t)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(z.a,{show:this.props.show,onHide:this.props.onHide,size:"lg"},r.a.createElement(z.a.Header,null,"Pick a design template"),r.a.createElement(z.a.Body,null,this.state.fetchError&&r.a.createElement(Qe,null),!this.state.templates&&!this.state.fetchError&&r.a.createElement(Xe,null),this.state.templates&&r.a.createElement(Ze,{templates:this.state.templates,onTemplatePicked:this.onTemplatePicked})),r.a.createElement(z.a.Footer,null,r.a.createElement(V.a,{variant:"secondary",onClick:this.props.onHide},"Cancel")))}}]),t}(a.Component),Qe=function(){return r.a.createElement(O.a,{variant:"danger"},"There's been an error while fetching the templates")},Xe=function(){return r.a.createElement("p",null,"Loading...")},Ze=function(e){var t=e.templates,n=e.onTemplatePicked;return r.a.createElement(j.a,null,r.a.createElement(w.a,null,t.map(function(e){return r.a.createElement(y.a,{xs:12,sm:6,key:e.id,className:"mb-2"},r.a.createElement(Ce.a,null,r.a.createElement(Ce.a.Header,null,e.name),r.a.createElement(Ce.a.Body,null,e.description),r.a.createElement(Ce.a.Footer,null,r.a.createElement(V.a,{onClick:function(){return n(e)}},"Choose"))))})))},et={type:"doDesign",Model:Ge,Widget:function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={templateJustPicked:!1},n.onModelUpdatedFromTemplate=function(){n.props.onModelUpdated(),n.setState({templateJustPicked:!0})},n.onModelUpdatedFromEditor=function(){n.props.onModelUpdated(),n.setState({templateJustPicked:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getModel",value:function(){return this.props.model}},{key:"render",value:function(){var e=this.getModel(),t=e.getDefinition();return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},t.description),e.isDesignEmpty()&&r.a.createElement(Ye,{designModel:e,onModelUpdated:this.onModelUpdatedFromTemplate,disabled:this.props.disabled}),r.a.createElement(Ve,{designModel:e,onModelUpdated:this.onModelUpdatedFromEditor,buttonText:e.isDesignEmpty()?"Create from scratch":"Open design editor",templateJustPicked:this.state.templateJustPicked,disabled:this.props.disabled}))}}]),t}(a.Component)},tt=Object(B.a)({},we,Object(I.a)({},et.type,et)),nt=function(e,t){var n={};return t.forEach(function(t){var a=t.name,r=function(e){var t=tt[e];if(!t)throw new Error("unknown parameter of type '".concat(e,"'"));return t.Model}(t.type);n[a]=new r(t,e)}),n},at=function(e){var t={};return Object.keys(e).forEach(function(n){return t[n]=e[n].serialize()}),t},rt=n(77),ot=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).blockRuns=[],n._runs=new rt.a([]),n.isValid=function(){return null==Object.values(n.getParameterModelsMap()).find(function(e){return!e.isValid()})},n.getId=function(){return n.id},n.getLabel=function(){return n.label},n.setId=function(e){return n.id=e},n.setLabel=function(e){return n.label=e},n.getParameterModelsMap=function(){return n.parameterModelsMap},n.getParameterDefinitionList=function(){return n.blockTypeDefinition.parameterDefinitions},n.getInitialParametersMap=function(){return n.initialParametersMap},n.getBlockRuns=function(){return n.blockRuns},n.getLatestRun=function(){return n.latestBlockRun},n.wasStarted=function(){return!!n.latestBlockRun},n.isRunning=function(){return n.wasStarted()&&n.getLatestRun().isRunning()},n.isFailed=function(){return n.wasStarted()&&n.getLatestRun().isFailed()},n.isFinished=function(){return n.wasStarted()&&n.getLatestRun().isFinished()},n.getRunnableBlocksCount=function(){return 1+t.getAllParentBlocks(Object(D.a)(Object(D.a)(n))).length},n.getRunningBlocksCount=function(){return[Object(D.a)(Object(D.a)(n))].concat(Object(S.a)(t.getAllParentBlocks(Object(D.a)(Object(D.a)(n))))).filter(function(e){return e.isRunning()}).length},n.getFinishedBlocksCount=function(){return[Object(D.a)(Object(D.a)(n))].concat(Object(S.a)(t.getAllParentBlocks(Object(D.a)(Object(D.a)(n))))).filter(function(e){return e.isFinished()}).length},n.canStart=function(){return!n.isRunning()&&(null==n._runs.getLatestRun()||!n._runs.getLatestRun().isRunning())},n.canBeEdited=function(){return!n.isRunning()},n.getFinishedRuns=function(){return n.blockRuns.filter(function(e){return e.isFinished()})},n.getParentBlocks=function(){return Object.values(n.getPort("in").getLinks()).map(function(e){return e.getSourcePort().getNode()})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"deSerialize",value:function(e,n){e.id||this.initializeBlockWithIds(e,n),Object(M.a)(Object(f.a)(t.prototype),"deSerialize",this).call(this,e,n),this.setLabel(e.label),this.blockTypeDefinition=n.getBlockTypeDefinition(e.type),this.initialParametersMap=e.parameters||{},this.setParameterModelsMap(nt(this,this.getParameterDefinitionList()))}},{key:"initializeBlockWithIds",value:function(e,t){e.id=Ae()(),e.label=t.getModel().getNextBlockLabel(),e.ports=e.ports.map(function(e){return Object(B.a)({},e,{id:Ae()()})})}},{key:"serialize",value:function(){return Object(B.a)({},Object(M.a)(Object(f.a)(t.prototype),"serialize",this).call(this),{label:this.getLabel(),type:this.blockTypeDefinition.name,parameters:at(this.getParameterModelsMap())})}},{key:"getColor",value:function(){return"#F7F7F7"}},{key:"getPortsAsList",value:function(){return Object.values(this.getPorts())}},{key:"setParameterModelsMap",value:function(e){this.parameterModelsMap=e}},{key:"setRuns",value:function(e){this._runs=e,this.latestBlockRun=e.getLatestRun()?e.getLatestRun().getBlockRun(this.getId()):null,this.blockRuns=e.getBlockRuns(this.getId())}}]),t}(C.DefaultNodeModel);ot.getAllParentBlocks=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.getParentBlocks();return n.length>0&&(t.push.apply(t,Object(S.a)(n)),n.forEach(function(e){return ot.getAllParentBlocks(e,t)})),t};var ct=n(241),it=(n(300),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.node;return r.a.createElement(Ce.a,{className:"block",style:{backgroundColor:e.getColor(),color:he(e.getColor())}},r.a.createElement(Ce.a.Header,null,r.a.createElement(C.PortWidget,{name:"in",node:e}),r.a.createElement("div",{className:"block-name"},e.name),r.a.createElement(C.PortWidget,{name:"out",node:e}),r.a.createElement("div",{className:"flags-container"},e.isFinished()&&r.a.createElement("i",{className:"fas fa-check-circle"}),e.isRunning()&&r.a.createElement(ct.a,{animation:"grow",size:"sm"}),e.isFailed()&&r.a.createElement("i",{className:"fas fa-exclamation-circle error"}),!e.isValid()&&r.a.createElement("i",{className:"fas fa-exclamation-triangle error"}))))}}]),t}(C.DefaultNodeWidget)),lt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,"".concat(e,"Factory")))).setBlockType(e),n}return Object(h.a)(t,e),Object(d.a)(t,null,[{key:"supportsBlockType",value:function(e){return!0}}]),Object(d.a)(t,[{key:"setBlockType",value:function(e){this.blockType=e}},{key:"getType",value:function(){return this.getBlockType()}},{key:"getBlockType",value:function(){return this.blockType}},{key:"getNewInstance",value:function(){return new ot}},{key:"generateReactWidget",value:function(e,t){return r.a.createElement(it,{node:t,diagramEngine:e})}}]),t}(C.DefaultNodeFactory),st=n(69),ut=st.a.FAILED,dt=st.a.RUNNING,pt=st.a.FINISHED,ft=st.a.NOT_STARTED,ht=function(){function e(t,n){var a=this;Object(u.a)(this,e),this.getBlockId=function(){return a.blockId},this.getRunId=function(){return a.publishRun.getRunId()},this.getCacheId=function(){return a.publishRun.getCacheId()},this.isRunning=function(){return a.publishRun.getState()===dt||a.waitRun.getState()===dt},this.isFailed=function(){return a.publishRun.getState()===ut||a.waitRun.getState()===ut},this.isFinished=function(){return a.publishRun.getState()===pt&&a.waitRun.getState()===pt},this.blockId=n,this.publishRun=e._getBlockRunOrNotStarted(t,n),this.waitRun=e._getBlockRunOrNotStarted(t,"".concat(n,"_wait"))}return Object(d.a)(e,null,[{key:"adaptRuns",value:function(t,n){return t.runs.map(function(t){return new e(t,n)})}}]),e}();ht._getBlockRunOrNotStarted=function(e,t){return e.getBlockRun(t)||{getState:function(){return ft}}};var mt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setRuns",value:function(e){this._runs=e,this.latestBlockRun=e.getLatestRun()?new ht(e.getLatestRun(),this.getId()):null,this.blockRuns=ht.adaptRuns(e,this.getId())}},{key:"getColor",value:function(){var e=this.getBlockingContextModelParameter();return e.isBlockingContextSelected()?this.getBlockingContexts().getBlockingContextById(e.getBlockingContextId()).color:Object(M.a)(Object(f.a)(t.prototype),"getColor",this).call(this)}},{key:"getBlockingContextModelParameter",value:function(){return this.getParameterModelsMap().blockingContextId}},{key:"getBlockingContexts",value:function(){return this.parent.getBlockingContexts()}}]),t}(ot),gt=[function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,"DoBlock"))).setBlockType(e),n}return Object(h.a)(t,e),Object(d.a)(t,null,[{key:"supportsBlockType",value:function(e){return"do"===e}}]),Object(d.a)(t,[{key:"getNewInstance",value:function(){return new mt}},{key:"generateReactWidget",value:function(e,t){return r.a.createElement(it,{node:t,diagramEngine:e})}}]),t}(lt),lt],bt=function(e){return gt.find(function(t){return t.supportsBlockType(e)})},vt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"canLinkToPort",value:function(e){if(!Object(M.a)(Object(f.a)(t.prototype),"canLinkToPort",this).call(this,e))return!1;var n=t.blockDependsOnItself(this.getBlock());return n&&console.info("Link prevented to avoid recursive dependencies"),!n}},{key:"getBlock",value:function(){return this.parent}},{key:"getConnectedBlocks",value:function(){var e=this;return this.getLinksAsList().map(function(t){return t.sourcePort===e?t.targetPort:t.sourcePort}).map(function(e){return e.getBlock()})}},{key:"getLinksAsList",value:function(){return Object.values(this.getLinks())}}],[{key:"blockDependsOnItself",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n[e.getId()]=!0;var a=e.getPort("out").getConnectedBlocks(),r=!0,o=!1,c=void 0;try{for(var i,l=a[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var s=i.value;if(n[s.getId()])return!0;if(t.blockDependsOnItself(s,n))return!0}}catch(u){o=!0,c=u}finally{try{r||null==l.return||l.return()}finally{if(o)throw c}}return n[e.getId()]=!1,!1}}]),t}(C.DefaultPortModel),kt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getNewInstance",value:function(e){return new vt}}]),t}(C.DefaultPortFactory),Et=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this))).setBlockTypeDefinitions(e),n.registerFactories(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setBlockTypeDefinitions",value:function(e){this.blockTypeDefinitions=e}},{key:"registerFactories",value:function(){this.registerLinkFactory(new x),this.registerPortFactory(new kt),this.registerLabelFactory(new C.DefaultLabelFactory),this.registerNodeFactories()}},{key:"registerNodeFactories",value:function(){var e=this;this.getBlockTypeDefinitions().forEach(function(t){var n=bt(t.name);e.registerNodeFactory(new n(t.name))})}},{key:"getBlockTypeDefinitions",value:function(){return this.blockTypeDefinitions}},{key:"getBlockTypeDefinition",value:function(e){return this.getBlockTypeDefinitions().find(function(t){return t.name===e})}},{key:"getModel",value:function(){return this.getDiagramModel()}}]),t}(C.DiagramEngine),jt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={deserializationError:!1},n.initGraph=function(){n.engine=new Et(n.props.blockTypeDefinitions),n.engine.setDiagramModel(n.getModel()),n.engine.blockTypeDefinitions=n.props.blockTypeDefinitions},n.deserializeGraph=function(e){if(e&&e.id)try{n.getModel().deSerializeDiagram(e,n.engine),n.addSelectedListenerToNodesOfModel()}catch(t){n.setState({deserializationError:!0}),console.error("[WorkflowGraphEditor] deserialization error",t)}},n.addSelectedListenerToNodesOfModel=function(){Object.values(n.getModel().getNodes()).forEach(n.addSelectedListener)},n.onDrop=function(e){n.isEventCausedByADroppedBlockType(e)&&n.onBlockTypeDropped(e)},n.isEventCausedByADroppedBlockType=function(e){return!!n.getBlockTypeDefinitionFromEvent(e)},n.onBlockTypeDropped=function(e){var t=n.getBlockTypeDefinitionFromEvent(e),a=n.getMousePosition(e);n.createNodeFromDroppedBlockType(t,a)},n.getBlockTypeDefinitionFromEvent=function(e){return JSON.parse(e.dataTransfer.getData("blockTypeDefinition"))},n.getMousePosition=function(e){return n.engine.getRelativeMousePoint(e)},n.createNodeFromDroppedBlockType=function(e,t){var a=n.createNodeFromBlockType(e,t);n.addNodeToGraph(a,e)},n.createNodeFromBlockType=function(e,t){var a=e.name,r=n.engine.getNodeFactory(a).getNewInstance();return r.parent=n.getModel(),r.deSerialize({name:e.displayName,type:e.name,ports:e.ports,color:e.color,x:t.x,y:t.y},n.engine),r},n.addNodeToGraph=function(e){n.addSelectedListener(e),n.getModel().addNode(e),n.props.onModelUpdate()},n.addSelectedListener=function(e){return e.addListener({selectionChanged:n.onSelectedNodeChanged,entityRemoved:n.onSelectedNodeChanged})},n.onSelectedNodeChanged=function(){var e=n.getSelectedNodes();if(1===e.length){var t=e[0];n.props.onBlockSelected(t)}else n.props.onBlockSelected(null)},n.getSelectedNodes=function(){return n.getModel().getSelectedItems("node")},n.getModel=function(){return n.props.graphModel},n.initGraph(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.deserializeGraph(this.props.initialGraph)}},{key:"render",value:function(){return this.state.deserializationError?r.a.createElement(wt,null):r.a.createElement("div",{onDrop:this.onDrop,onDragOver:function(e){return e.preventDefault()},className:"diagram-widget-container"},r.a.createElement(C.DiagramWidget,{diagramEngine:this.engine}))}}]),t}(a.Component),wt=function(){return r.a.createElement("div",{className:"deserialization-error-container"},r.a.createElement(O.a,{className:"deserialization-error",variant:"danger"},"Can't deserialize graph."))},yt=function(e){var t=e.blockTypeDefinitions;return r.a.createElement("div",null,r.a.createElement("h5",null,"Blocks"),r.a.createElement(w.a,null,r.a.createElement(y.a,null,t.map(function(e){return r.a.createElement(Ce.a,{className:"mb-2",key:e.id,draggable:!0,onDragStart:function(t){return t.dataTransfer.setData("blockTypeDefinition",JSON.stringify(e))}},r.a.createElement(Ce.a.Header,{className:"btn-block d-flex justify-content-center"},e.displayName))}))))},Ot=function(e){function t(e){var n;Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onChangeName=function(e){return n.setState({name:e.target.value})},n.onChangeDescription=function(e){return n.setState({description:e.target.value})},n.onBlur=function(){return n.props.onEdit(Object(B.a)({},n.props.workflow,{name:n.state.name||n.props.name,description:n.state.description||n.props.description}))};var a=e.workflow,r=a.name,o=a.description;return n.state={name:r,description:o},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ie,{title:"Name"},r.a.createElement(N.a.Control,{name:"name",type:"text",value:this.state.name,onChange:this.onChangeName,onBlur:this.onBlur,disabled:this.props.disabled})),r.a.createElement(Ie,{title:"Description"},r.a.createElement(N.a.Control,{name:"description",type:"text",as:"textarea",value:this.state.description,onChange:this.onChangeDescription,onBlur:this.onBlur,disabled:this.props.disabled})))}}]),t}(a.Component),Ct=n(58),xt=n(474),Bt=n(472),St=n(473),Mt=n(228),Dt=n(227),It=(n(301),n(46)),Nt={downloadAndSave:function(){var e=Object(s.a)(l.a.mark(function e(t,n){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.download(t);case 2:a=e.sent,this.save(a,n);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),download:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,Object(g.b)({}));case 2:return n=e.sent,e.next=5,n.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),save:function(e,t){var n="data:application/pdf;base64,".concat(btoa(e)),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}},Rt=["json","csv"],Tt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={downloadFormat:Rt[0]},n.onChangeDownloadFormat=function(e){return n.setState({downloadFormat:e})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.runnable,n=e.downloadLinkFactory,a=e.downloadNameFactory;if(t.getFinishedRuns().length<=0)return r.a.createElement(Wt,null);var o=this.state.downloadFormat,c=t.getFinishedRuns()[0];return r.a.createElement("div",null,"Download results as",r.a.createElement(Bt.a,{className:"mt-2 mb-1 format-toggle-group"},r.a.createElement(St.a,{type:"radio",name:"downloadFormat",defaultValue:Rt[0],onChange:this.onChangeDownloadFormat},Rt.map(function(e){return r.a.createElement(Mt.a,{key:e,value:e},e.toUpperCase())}))),r.a.createElement(le.a,{as:Dt.a,className:"btn-block"},r.a.createElement(Pt,{link:n(c,o),name:a(c,o),isLatest:!t.isRunning(),id:c.getRunId()}),r.a.createElement(le.a.Toggle,{split:!0,variant:"success"}),r.a.createElement(le.a.Menu,null,t.getFinishedRuns().map(function(e,i){return r.a.createElement(At,{key:e.getRunId(),link:n(e,o),name:a(c,o),isLatest:!t.isRunning()&&0===i,id:e.getRunId()})}))))}}]),t}(a.Component),Wt=function(){return r.a.createElement("span",null,"No results available yet")},Pt=function(e){var t=e.link,n=e.name,a=e.isLatest,o=e.id;return r.a.createElement("a",{className:"btn btn-success",style:{color:"white"},onClick:Object(It.a)(function(){return Nt.downloadAndSave(t,n)})},a?"Download latest results":"Download #".concat(o))},At=function(e){var t=e.link,n=e.name,a=e.isLatest,o=e.id;return r.a.createElement(le.a.Item,{onClick:Object(It.a)(function(){return Nt.download(t,n)})},"#",o," ",a?"- Latest ":"")},Ft=(n(302),function(e){return r.a.createElement("div",null,!e.readOnly&&r.a.createElement(Lt,e),r.a.createElement(Ut,e))}),Lt=function(e){var t=e.runnable,n=(e.downloadLinkFactory,e.onStart),a=e.isStarting,o=e.startText;return r.a.createElement(Ce.a,null,r.a.createElement(Ce.a.Header,null,"Execution"),r.a.createElement(Ce.a.Body,null,t.isRunning()&&r.a.createElement("div",null,"Workflow is currently running (run #",t.getLatestRun().getRunId(),").",r.a.createElement("br",null),"Progress:",r.a.createElement("br",null),r.a.createElement(Vt,{runnable:t})),r.a.createElement(je.a,{block:!0,onClick:n,disabled:!t.canStart(),isLoading:a},o)))},Ut=function(e){var t=e.runnable,n=e.downloadLinkFactory,a=e.downloadNameFactory;return r.a.createElement(Ce.a,{className:"mt-2"},r.a.createElement(Ce.a.Header,null,"Results"),r.a.createElement(Ce.a.Body,null,r.a.createElement(Tt,{downloadLinkFactory:n,downloadNameFactory:a,runnable:t})))},Vt=function(e){var t=e.runnable,n=Math.ceil(t.getFinishedBlocksCount()/t.getRunnableBlocksCount()*100),a=Math.ceil(t.getRunningBlocksCount()/t.getRunnableBlocksCount()*100);return r.a.createElement("div",null,r.a.createElement(xt.a,{className:"progress-bars-container"},r.a.createElement(xt.a,{animated:!0,variant:"primary",now:Math.max(1,n),key:1}),r.a.createElement(xt.a,{animated:!0,variant:"success",now:a,key:2})),r.a.createElement("div",{className:"progress-bar-legend"},r.a.createElement("div",{className:"legend-item"},r.a.createElement("div",{className:"progress-bar-sample progress-bar bg-primary progress-bar-striped"}),"Finished blocks"),r.a.createElement("div",{className:"legend-item"},r.a.createElement("div",{className:"progress-bar-sample progress-bar bg-success progress-bar-striped"}),"Running blocks")))},zt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isStarting:!1,startError:!1},n.startWorkflow=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isStarting:!0,startError:!1}),e.prev=1,e.next=4,m.b.saveAndStartWorkflow(n.getWorkflow());case 4:return t=e.sent,e.next=7,n.waitForRunStateReceived(t);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setState({startError:!0});case 12:n.setState({isStarting:!1});case 13:case"end":return e.stop()}},e,null,[[1,9]])})),n.waitForRunStateReceived=function(e){return new Promise(function(t,a){n.props.runnableWorkflow.addRunsListener(function n(a){a.getRuns().containsRun(e)&&(a.removeRunsListener(n),t())})})},n.getWorkflow=function(){return n.props.runnableWorkflow.getWorkflow()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state.isStarting,t=this.props,n=t.runnableWorkflow,a=t.readOnly,o=this.getWorkflow();return r.a.createElement("div",null,this.state.startError&&r.a.createElement(O.a,{variant:"danger"},"Can't start workflow!"),r.a.createElement(Ft,{runnable:n,downloadLinkFactory:function(e,t){return Ct.a.getDownloadLink(e,t)},downloadNameFactory:function(e,t){return"".concat(o.name," #").concat(e.id,".").concat(t)},startText:"Start workflow",onStart:this.startWorkflow,isStarting:e,readOnly:a}))}}]),t}(a.Component),_t=(n(303),function(e){var t=e.title,n=e.center;return r.a.createElement("div",{className:"sidebar-column"},r.a.createElement("div",{className:"title-and-center-container"},r.a.createElement(w.a,null,r.a.createElement(y.a,null,r.a.createElement("h5",null,t))),n))}),Gt=(n(304),n(229)),qt=n(485),Ht=function(e){function t(e){var n;Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).pickRandomColor=function(){var e=se();n.setState({color:e,userText:e},function(){return n.props.onChange(n.state.color)})},n.onInputChange=function(e){var t=e.target.value;n.setState({userText:t}),pe(t)&&(n.setState({color:t}),n.props.onChange(t))};var a=e.color;return a||(a=se(),n.props.onChange(a)),n.state={color:a,userText:a},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.color,n=e.userText;return r.a.createElement(ee.a,{className:"mb-3"},r.a.createElement(ee.a.Prepend,null,r.a.createElement(V.a,{variant:"outline-secondary",onClick:this.pickRandomColor,style:{backgroundColor:t,borderColor:t,color:he(t)}},r.a.createElement("i",{className:"fas fa-sync-alt"}))),r.a.createElement(te.a,{"aria-describedby":"basic-addon1",value:n,onChange:this.onInputChange}))}}]),t}(a.Component),Jt=(n(305),"<p><h1>Thank you</h1>You've already worked on another job related to this project</p>"),Kt=function(){function e(t){var n=this;Object(u.a)(this,e),this.contexts=[],this._enableContextForAllDoBlocks=function(e){return n.getBlockingContextModelsOfDoBlocks().forEach(function(t){return t.setBlockingContextId(e.id)})},this.getBlockingContextModelsOfDoBlocks=function(){return n.getDoBlockModels().map(function(e){return e.getBlockingContextModelParameter()})},this._disableContextForAllDoBlocks=function(e){return n.getBlockingContextModelsOfDoBlocks().filter(function(t){return t.getBlockingContextId()===e.id}).forEach(function(e){return e.setBlockingContextId(null)})},this.isSingleBlockingContextEnabledForAllDoBlocks=function(){var e=1===n.getContexts().length,t=n.graphModel.getBlocksArray(),a=n.getBlockingContextModelsOfDoBlocks().filter(function(e){return!!e.getBlockingContextId()});return e&&t.length===a.length},this.areSomeBlockingContextsEnabled=function(){return n.getBlockingContextModelsOfDoBlocks().filter(function(e){return!!e.getBlockingContextId()}).length>0},this.graphModel=t}return Object(d.a)(e,[{key:"deSerialize",value:function(e){this.setContexts(e)}},{key:"setContexts",value:function(e){this.contexts=e}},{key:"serialize",value:function(){return this.getContexts()}},{key:"getContexts",value:function(){return this.contexts}},{key:"getBlockingContextById",value:function(e){return this.getContexts().find(function(t){return t.id===e})}},{key:"removeContext",value:function(e){var t=this.contexts.indexOf(e);t>=0&&(this._disableContextForAllDoBlocks(e),this.contexts.splice(t,1))}},{key:"addContext",value:function(e){this.contexts.push(e)}},{key:"mutateToSingleBlockingContextForAllDoBlocks",value:function(){this.removeAllBlockingContexts();var t=e.getDefaultContext();this.addContext(t),this._enableContextForAllDoBlocks(t)}},{key:"getDoBlockModels",value:function(){return this.graphModel.getBlocksArray().filter(function(e){return e instanceof mt})}},{key:"removeAllBlockingContexts",value:function(){var e=this;this.contexts.forEach(function(t){e._disableContextForAllDoBlocks(t),e.removeContext(t)})}}]),e}();Kt.getDefaultContext=function(){return{id:"default-blocking-context",name:"Default",color:"#ffaff3",workerBlockedMessage:"<p><h1>Thank you</h1>You've already worked on another job related to this project</p>"}};var Yt=function(e){var t=e.name,n=e.workerBlockedMessage;return t&&t.length>=0&&n&&n.length>=0},$t=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).togglePopoverButton=r.a.createRef(),n.popoverContent=r.a.createRef(),n.state={show:!1},n.showPopover=function(){n.setState({show:!0}),n.registerListenerToClosePopoverWhenUserClicksOutside()},n.clickListenerToClosePopoverWhenUserClicksOutside=function(e){var t=n.popoverContent.current;e.composedPath().indexOf(t)>=0||n.hidePopover()},n.onCreated=function(e){n.hidePopover(),n.props.onAdd(e)},n.hidePopover=function(){n.setState({show:!1}),n.unregisterListenerToClosePopoverWhenUserClicksOutside()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"registerListenerToClosePopoverWhenUserClicksOutside",value:function(){document.body.addEventListener("click",this.clickListenerToClosePopoverWhenUserClicksOutside)}},{key:"unregisterListenerToClosePopoverWhenUserClicksOutside",value:function(){document.body.removeEventListener("click",this.clickListenerToClosePopoverWhenUserClicksOutside)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(V.a,{className:"btn-block",onClick:this.showPopover,ref:this.togglePopoverButton},"Add experimental group"),r.a.createElement(Gt.a,{id:"create-blocking-context-popover-container",show:this.state.show,placement:"left",target:this.togglePopoverButton.current,container:document.getElementById("workflow-editor")},r.a.createElement(qt.a,{title:"Create experimental group",id:"create-blocking-context-popover",placement:"left"},r.a.createElement("div",{ref:this.popoverContent},r.a.createElement(Qt,{onCreated:this.onCreated})))))}}]),t}(a.Component),Qt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",color:null,workerBlockedMessage:Jt},n.onNameChange=function(e){return n.setState({name:e.target.value})},n.onChangeColor=function(e){return n.setState({color:e})},n.getBlockingContextFromState=function(){return Object(B.a)({},n.state)},n.onAdd=function(){n.props.onCreated(Object(B.a)({id:Ae()()},n.getBlockingContextFromState())),n.setState({name:"",color:null})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.color;return r.a.createElement("div",{style:{padding:"10px",paddingBottom:"0"}},r.a.createElement(N.a.Row,null,r.a.createElement(y.a,{xs:"12"},r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Control,{name:"name",type:"text",placeholder:"Experimental group name",value:t,onChange:this.onNameChange}))),r.a.createElement(y.a,{xs:"8"},r.a.createElement(Ht,{color:n,onChange:this.onChangeColor})),r.a.createElement(y.a,{xs:"4"},r.a.createElement(V.a,{className:"btn-block",disabled:!Yt(this.getBlockingContextFromState()),onClick:this.onAdd},"Add"))))}}]),t}(a.Component),Xt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1},n.onShowModal=function(){return n.setState({show:!0})},n.onCloseModal=function(){return n.setState({show:!1})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement(Zt,{show:this.state.show,onClose:this.onCloseModal,context:this.props.context,onModelUpdate:this.props.onModelUpdate}),r.a.createElement("a",{className:"icon-button",onClick:Object(It.a)(this.onShowModal)},r.a.createElement("i",{className:"fas fa-edit"})))}}]),t}(a.Component),Zt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={name:null,color:null,workerBlockedMessage:null},n.resetInputFields=function(){return n.setState(Object(B.a)({},n.props.context))},n.onSave=function(){n.updatePropsContext(),n.props.onClose()},n.updatePropsContext=function(){var e=n.state,t=e.name,a=e.color,r=e.workerBlockedMessage,o=n.props.context;o.name=t,o.color=a,o.workerBlockedMessage=r,n.props.onModelUpdate()},n.onCancel=function(){n.resetInputFields(),n.props.onClose()},n.onNameChange=function(e){return n.setState({name:e.target.value})},n.onColorChange=function(e){return n.setState({color:e})},n.onWorkerBlockedMessageChange=function(e){n.setState({workerBlockedMessage:e})},n.getBlockingContextFromState=function(){return Object(B.a)({},n.state)},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.resetInputFields()}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.color,a=e.workerBlockedMessage;return r.a.createElement(z.a,{show:this.props.show,size:"xl"},r.a.createElement(z.a.Header,null,"Blocking context editor"),r.a.createElement(z.a.Body,null,r.a.createElement(N.a.Row,null,r.a.createElement(y.a,{xs:"12",sm:"9"},r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Control,{name:"name",type:"text",placeholder:"Blocking context name",value:t,onChange:this.onNameChange}))),r.a.createElement(y.a,{xs:"12",sm:"3"},r.a.createElement(Ht,{color:n,onChange:this.onColorChange}))),r.a.createElement(w.a,null,r.a.createElement(y.a,null,r.a.createElement(U.a,{onEditorChange:this.onWorkerBlockedMessageChange,initialValue:a,init:{menubar:!1}})))),r.a.createElement(z.a.Footer,null,r.a.createElement(V.a,{variant:"secondary",onClick:this.onCancel},"Cancel"),r.a.createElement(V.a,{className:"confirm",onClick:this.onSave,disabled:!Yt(this.getBlockingContextFromState())},"Save")))}}]),t}(a.Component),en=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).getBlockingContextsModel=function(){return n.props.graphModel.getBlockingContexts()},n.onAddBlockingContext=function(e){n.getBlockingContextsModel().addContext(e),n.props.onModelUpdate()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.getBlockingContextsModel(),t=this.props.disabled;return r.a.createElement("div",null,r.a.createElement(N.a.Text,{className:"text-muted"},r.a.createElement("strong",null,"Experimental groups")),r.a.createElement(tn,{model:e,onModelUpdate:this.props.onModelUpdate,disabled:t}),!t&&r.a.createElement($t,{onAdd:this.onAddBlockingContext}))}}]),t}(a.Component),tn=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).getBlockingContextsModel=function(){return n.props.model},n.getContexts=function(){return n.getBlockingContextsModel().getContexts()},n.isDisabled=function(){return n.props.disabled},n.renderNoBlockingContextsYet=function(){return r.a.createElement(N.a.Text,{className:"text-muted"},"No experimental groups created yet in this workflow.")},n.renderTable=function(){return r.a.createElement(H.a,{striped:!0,bordered:!0,hover:!0,size:"sm",className:"blocking-contexts-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",{className:"name-column"},"Name"),!n.isDisabled()&&r.a.createElement("th",null))),r.a.createElement("tbody",null,n.getContexts().map(function(e){return r.a.createElement(nn,{key:e.id,context:e,disabled:n.isDisabled(),blockingContextsModel:n.getBlockingContextsModel(),onModelUpdate:n.props.onModelUpdate})})))},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return this.getContexts().length<=0?this.renderNoBlockingContextsYet():this.renderTable()}}]),t}(a.Component),nn=function(e){var t=e.context,n=e.disabled,a=e.blockingContextsModel,o=e.onModelUpdate;return r.a.createElement("tr",null,r.a.createElement("td",{className:"color-box-container"},r.a.createElement("div",{className:"color-box",style:{backgroundColor:t.color}})),r.a.createElement("td",null,t.name),!n&&r.a.createElement("td",{className:"actions-cell"},r.a.createElement("div",{className:"actions"},r.a.createElement(Xt,{context:t,onModelUpdate:o}),r.a.createElement(an,{blockingContextsModel:a,context:t,onModelUpdate:o}))))},an=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onRemoveContext=function(e){n.getBlockingContextsModel().removeContext(e),n.props.onModelUpdate()},n.getBlockingContextsModel=function(){return n.props.blockingContextsModel},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.context;return r.a.createElement("a",{className:"icon-button delete",onClick:function(){return e.onRemoveContext(t)}},r.a.createElement("i",{className:"fas fa-trash-alt"}))}}]),t}(a.Component),rn=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).checkboxRef=r.a.createRef(),n.onChange=function(){var e=n.getBlockingContextsModel();n.isIndeterminate()||!e.areSomeBlockingContextsEnabled()?e.mutateToSingleBlockingContextForAllDoBlocks():e.removeAllBlockingContexts(),n.props.onModelUpdate()},n.getBlockingContextsModel=function(){return n.props.graphModel.getBlockingContexts()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.renderCheckboxIndeterminateState()}},{key:"render",value:function(){var e=this.getBlockingContextsModel();return this.renderCheckboxIndeterminateState(),r.a.createElement("div",null,r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Text,{className:"text-muted"},"If checked, workers will be able to work only on one experimental group of this workflow."),r.a.createElement(N.a.Check,{ref:this.checkboxRef,type:"checkbox",label:"Should workers participate in more than one experimental group?",checked:e.areSomeBlockingContextsEnabled(),onChange:this.onChange,disabled:this.props.disabled})))}},{key:"renderCheckboxIndeterminateState",value:function(){var e=this.checkboxRef.current;e&&(e.indeterminate=this.isIndeterminate())}},{key:"isIndeterminate",value:function(){var e=this.getBlockingContextsModel();return e.areSomeBlockingContextsEnabled()&&!e.isSingleBlockingContextEnabledForAllDoBlocks()}}]),t}(a.Component),on=function(e){var t=e.graphModel,n=e.onModelUpdate,a=e.disabled;return r.a.createElement(Ie,{title:"Experimental groups"},r.a.createElement(rn,{graphModel:t,onModelUpdate:n,disabled:a}),r.a.createElement(en,{graphModel:t,onModelUpdate:n,disabled:a}))},cn=function(e){var t=e.runnableWorkflow,n=e.onEdit,a=e.onModelUpdate,o=e.graphModel,c=e.readOnly,i=t.getWorkflow(),l=c;return r.a.createElement(_t,{title:"Workflow properties",center:r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement(Ot,{onEdit:n,workflow:i,disabled:l}),r.a.createElement(on,{graphModel:o,onModelUpdate:a,disabled:l}),r.a.createElement(zt,{runnableWorkflow:t,readOnly:c}))})},ln=(n(306),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).componentDidUpdate=function(e){e.blockModel!==n.getBlockModel()&&n.setState({label:n.getLabel()})},n.getBlockModel=function(){return n.props.blockModel},n.getLabel=function(){return n.getBlockModel().getLabel()},n.getGraphModel=function(){return n.props.graphModel},n.onChange=function(e){return n.setState({label:e.target.value},function(){n.isNewLabelValid()&&n.replaceLabel()})},n.isNewLabelValid=function(){return n.getGraphModel().isNewLabelValid(n.getBlockModel(),n.state.label)},n.replaceLabel=function(){n.getBlockModel().setLabel(n.state.label)},n.state={label:n.getLabel()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(Ie,{title:"Label"},r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Text,{className:"text-muted"},"Label of the block"),r.a.createElement(N.a.Control,{type:"text",value:this.state.label,onChange:this.onChange,isInvalid:!this.isNewLabelValid(),disabled:this.props.disabled}),r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"The label must be unique to all the blocks and must be at least one character long.")))}}]),t}(a.Component)),sn="".concat(b.a,"/cache"),un=function(e,t){return"".concat(sn,"/").concat(e,"?format=").concat(t)},dn=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.blockModel;return r.a.createElement(Ft,{runnable:e,downloadLinkFactory:function(e,t){return un(e.getCacheId(),t)},downloadNameFactory:function(t,n){return"".concat(e.getLabel()," #").concat(t.getRunId(),".").concat(n)},startText:"Start block",onStart:function(){return console.error("not implemented yet")},isStarting:!1,readOnly:this.props.readOnly})}}]),t}(a.Component),pn=function(e){var t=e.block,n=e.graphModel,a=e.onModelUpdate,o=e.runnableWorkflow,c=e.disabled,i=e.readOnly;return r.a.createElement(_t,{title:"Block parameters",center:r.a.createElement("div",{className:"parameters-engine-container",onKeyUp:function(e){e.stopPropagation()}},r.a.createElement("hr",null),r.a.createElement(ln,{blockModel:t,graphModel:n,disabled:c}),r.a.createElement(Me,{parametrizedBlock:t,onParameterModelUpdate:a,disabled:c,parametersInCard:!0}),r.a.createElement(dn,{blockModel:t,runnableWorkflow:o,disabled:c,readOnly:i}))})},fn=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).blockingContexts=new Kt(Object(D.a)(Object(D.a)(n))),n.isValid=function(){return null==n.getBlocksArray().find(function(e){return!e.isValid()})},n.getBlocks=function(){return n.getNodes()},n.getBlocksArray=function(){return Object.values(n.getBlocks())},n.isNewLabelValid=function(e,t){if(t.length<=0)return!1;var a=n.getBlockByLabelOrNull(t);return a===e||null==a},n.getBlockByLabelOrNull=function(e){return n.getBlocksArray().find(function(t){return t.getLabel()===e})},n.getNextBlockLabel=function(){return"block_".concat(n.getBlocksArray().length)},n.setRuns=function(e){return n.getBlocksArray().forEach(function(t){return t.setRuns(e)})},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"deSerialize",value:function(e,n){Object(M.a)(Object(f.a)(t.prototype),"deSerialize",this).call(this,e,n),this.blockingContexts.deSerialize(e.blockingContexts||[])}},{key:"serialize",value:function(){return Object(B.a)({},Object(M.a)(Object(f.a)(t.prototype),"serialize",this).call(this),{blockingContexts:this.blockingContexts.serialize()})}},{key:"getBlockingContexts",value:function(){return this.blockingContexts}}]),t}(C.DiagramModel),hn=n(489),mn=n(34),gn=n(38),bn=n(40),vn=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={projectName:null},n.componentDidMount=function(){return n.fetchProjectName()},n.fetchProjectName=Object(s.a)(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.workflow.projectId,e.prev=1,e.next=4,bn.a.getProject(t);case 4:a=e.sent,r=a.data,n.setState({projectName:r.name}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}},e,null,[[1,9]])})),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.workflow,t=e.name,n=e.projectId;return r.a.createElement("div",{className:"workflow-breadcrumb"},r.a.createElement(hn.a,null,r.a.createElement(mn.a,{to:gn.a},"Projects"),r.a.createElement(mn.a,{to:"".concat(gn.a,"/").concat(n)},this.state.projectName||r.a.createElement(ct.a,{animation:"grow",size:"sm"})),r.a.createElement(mn.a,{to:"".concat(gn.a,"/").concat(n)},"Workflows"),r.a.createElement(mn.b,null,t)))}}]),t}(a.Component),kn=n(483),En=n(117),jn=(n(450),function(e){var t=e.runnableWorkflow,n=e.graphModel,a=e.isSaving,o=e.onSavePressed,c=e.saveError,i=e.disabled,l=n.isValid(),s=t.getWorkflow();return r.a.createElement(kn.a,{className:"light-background justify-content-between workflow-bottom-navbar"},r.a.createElement(En.a,{text:"Return to project",to:"".concat(gn.a,"/").concat(s.projectId)}),r.a.createElement("div",null,!l&&r.a.createElement("span",{className:"warning"},r.a.createElement("i",{className:"fas fa-exclamation-triangle"})," Workflow contains some errors"),i&&r.a.createElement("span",null,"Edit is disabled while the workflow is running"),!i&&c&&r.a.createElement("span",{className:"warning"},r.a.createElement("i",{className:"fas fa-exclamation-triangle"})," Error while saving the workflow")),r.a.createElement(je.a,{disabled:!l||a||i,isLoading:a,onClick:o},"Save"))}),wn=n(477),yn=n(478),On=(n(451),function(){return r.a.createElement(wn.a,{placement:"bottom",overlay:r.a.createElement(yn.a,null,"To remove a link hold ",r.a.createElement("strong",null,"shift")," and click the link with the right mouse button.")},r.a.createElement(V.a,{className:"instructions-trigger",variant:"secondary"},r.a.createElement("i",{className:"far fa-question-circle"})))}),Cn=function(e){function t(e){var n;Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).graphModel=new fn,n.state={selectedBlock:null},n.onRunsUpdate=function(e){n.graphModel.setLocked(n.isEditDisabled()),n.graphModel.setRuns(e.getRuns()),n.onModelUpdated()},n.onModelUpdated=function(){console.log("[WorkflowEditor] onModelUpdated()"),n.onWorkflowEdited(),n.forceUpdate()},n.onBlockSelected=function(e){return n.setState({selectedBlock:e})},n.onSavePressed=function(){n.onModelUpdated(),n.props.onSave()},n.onWorkflowEdited=function(e){e||(e=n.getWorkflow()),e.graph=n.graphModel.serializeDiagram(),n.props.onWorkflowEdited(e)},n.getWorkflow=function(){return n.props.runnableWorkflow.getWorkflow()},n.isReadOnly=function(){return n.props.readOnly},n.isEditDisabled=function(){return n.isReadOnly()||!n.props.runnableWorkflow.canBeEdited()};var a=n.props.runnableWorkflow;return n.graphModel.workflowId=a.getWorkflow().id,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.runnableWorkflow;this.onRunsUpdate(e),e.addRunsListener(this.onRunsUpdate)}},{key:"componentWillUnmount",value:function(){this.props.runnableWorkflow.removeRunsListener(this.onRunsUpdate)}},{key:"render",value:function(){var e=this.props,t=e.runnableWorkflow,n=e.blockTypeDefinitions,a=t.getWorkflow(),o=a.graph;return r.a.createElement(j.a,{className:this.getStyleClasses(),id:"workflow-editor"},r.a.createElement(w.a,{className:"full-height"},!this.isEditDisabled()&&r.a.createElement(y.a,{className:"editor-left-sidebar light-background"},r.a.createElement(yt,{blockTypeDefinitions:n})),r.a.createElement(y.a,{className:"editor-center graph-editor-container"},r.a.createElement(jt,{initialGraph:o,graphModel:this.graphModel,blockTypeDefinitions:n,onBlockSelected:this.onBlockSelected,onModelUpdate:this.onModelUpdated}),r.a.createElement(vn,{workflow:a}),r.a.createElement(On,null),!this.isReadOnly()&&r.a.createElement(jn,{runnableWorkflow:t,graphModel:this.graphModel,onSavePressed:this.onSavePressed,isSaving:this.props.isSaving,saveError:this.props.saveError,disabled:this.isEditDisabled()})),r.a.createElement(y.a,{className:"editor-right-sidebar light-background"},this.state.selectedBlock?r.a.createElement(pn,{block:this.state.selectedBlock,graphModel:this.graphModel,onModelUpdate:this.onModelUpdated,runnableWorkflow:t,readOnly:this.isReadOnly(),disabled:this.isEditDisabled()}):r.a.createElement(cn,{runnableWorkflow:t,onEdit:this.onWorkflowEdited,graphModel:this.graphModel,onModelUpdate:this.onModelUpdated,readOnly:this.isReadOnly(),disabled:this.isEditDisabled()}))))}},{key:"getStyleClasses",value:function(){var e=["full-width","workflow-editor-container"];return this.isReadOnly()&&e.push("read-only"),e.join(" ")}}]),t}(a.Component),xn=(n(452),n(22)),Bn=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={blockTypeDefinitions:null,fetchingBlockTypeDefinitions:!1,fetchBlockTypesError:!1},n.componentDidMount=function(){return n.fetchBlockTypes()},n.componentWillUnmount=function(){return n.blockTypesRequest.cancel()},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"fetchBlockTypes",value:function(){var e=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({fetchingBlockTypeDefinitions:!0}),e.prev=1,this.blockTypesRequest=Object(g.c)(E.getBlockTypeDefinitions()),e.next=5,this.blockTypesRequest.result;case 5:t=e.sent,this.setState({blockTypeDefinitions:t,fetchingBlockTypeDefinitions:!1,fetchBlockTypesError:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.setState({fetchingBlockTypeDefinitions:!1,fetchBlockTypesError:!0});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(xn.a,{loading:this.state.fetchingBlockTypeDefinitions||!this.props.runnableWorkflow},r.a.createElement(Cn,Object.assign({},this.props,{blockTypeDefinitions:this.state.blockTypeDefinitions})))}}]),t}(a.Component),Sn=n(239),Mn=function e(t,n){var a=this;Object(u.a)(this,e),this.runsListeners=[],this.getWorkflow=function(){return a.workflow},this.setWorkflow=function(e){return a.workflow=e},this.getRuns=function(){return a.runs},this.setRuns=function(e){a.runs=e,a.notifyRunsListeners()},this.notifyRunsListeners=function(){return a.runsListeners.forEach(function(e){return e(a)})},this.addRunsListener=function(e){return a.runsListeners.push(e)},this.removeRunsListener=function(e){var t=a.runsListeners.indexOf(e);if(t<0)throw new Error("can't remove a listener that hasn't been added");a.runsListeners.splice(t,1)},this.wasStarted=function(){return!!a.getRuns().getLatestRun()},this.isRunning=function(){return a.wasStarted()&&a.getRuns().getLatestRun().isRunning()},this.isFailed=function(){return a.wasStarted()&&a.getRuns().getLatestRun().isFailed()},this.isFinished=function(){return a.wasStarted()&&a.getRuns().getLatestRun().isFinished()},this.getRunnableBlocksCount=function(){return a.getWorkflow().graph.nodes.length},this.getRunningBlocksCount=function(){return a.wasStarted()?a.getRuns().getLatestRun().getRunningBlockRuns().length:0},this.getFinishedBlocksCount=function(){return a.wasStarted()?a.getRuns().getLatestRun().getFinishedBlockRuns().length:0},this.canStart=function(){return!a.isRunning()},this.canBeEdited=function(){return!a.isRunning()},this.getLatestRun=function(){return a.getRuns().getLatestRun()},this.getFinishedRuns=function(){return a.getRuns().getFinishedRuns()},this.workflow=t,this.runs=n},Dn={WorkflowsService:m.b,RunsService:Ct.a,pollInterval:null,getRunnableWorkflow:function(){var e=Object(s.a)(l.a.mark(function e(t){var n,a,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.WorkflowsService.getWorkflow(t),this.RunsService.getRunsOfWorkflow(t)]);case 2:return n=e.sent,a=Object(Sn.a)(n,2),r=a[0],o=a[1],e.abrupt("return",new Mn(r,o));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),startWatchingRunsStatus:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;if(null!=this.pollInterval)throw new Error("multiple watching not implemented yet");var a=e.getWorkflow().id;this.pollInterval=setInterval(Object(s.a)(l.a.mark(function n(){var r;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.RunsService.getRunsOfWorkflow(a);case 2:r=n.sent,e.setRuns(r);case 4:case"end":return n.stop()}},n)})),n)},stopWatchRunsStatus:function(){clearInterval(this.pollInterval),this.pollInterval=null}},In=n(81),Nn="".concat(b.a,"/public-workflows"),Rn={getWorkflow:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)("".concat(Nn,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",Object(m.a)(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Tn=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={runnableWorkflow:null},n.componentDidMount=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.fetchRunnableWorkflow();case 3:t=e.sent,Dn.startWatchingRunsStatus(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),Object(In.a)(Object(D.a)(Object(D.a)(n)));case 11:case"end":return e.stop()}},e,null,[[0,7]])})),n.getWorkflowIdFromUrl=function(){return n.getWorkflowIdFromSpecifiedProps(n.props)},n.getWorkflowIdFromSpecifiedProps=function(e){return e.match.params.id},n.componentWillUnmount=function(){n.runnableWorkflowRequest.cancel(),Dn.stopWatchRunsStatus()},n.onWorkflowEdited=function(e){n.setWorkflow(e),n.forceUpdate()},n.setWorkflow=function(e){return n.state.runnableWorkflow.setWorkflow(e)},n.getWorkflow=function(){return n.state.runnableWorkflow.getWorkflow()},n.initializeRunnableWorkflowService(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"initializeRunnableWorkflowService",value:function(){Dn.WorkflowsService=Rn,Dn.RunsService={getRunsOfWorkflow:function(){return new rt.a([])}}}},{key:"componentDidUpdate",value:function(e,t,n){this.getWorkflowIdFromUrl()!==this.getWorkflowIdFromSpecifiedProps(e)&&(this.componentWillUnmount(),this.componentDidMount())}},{key:"fetchRunnableWorkflow",value:function(){var e=Object(s.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getWorkflowIdFromUrl(),this.setState({runnableWorkflow:null}),this.runnableWorkflowRequest=Object(g.c)(Dn.getRunnableWorkflow(t)),e.next=5,this.runnableWorkflowRequest.result;case 5:return n=e.sent,this.setState({runnableWorkflow:n}),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.runnableWorkflow;return r.a.createElement(Bn,{runnableWorkflow:e,onWorkflowEdited:this.onWorkflowEdited,readOnly:!0})}}]),t}(a.Component),Wn=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onSave=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isSaving:!0}),e.prev=1,t=n.getWorkflow(),e.next=5,m.b.updateWorkflow(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n.setState({saveError:!0});case 10:n.setState({isSaving:!1});case 11:case"end":return e.stop()}},e,null,[[1,7]])})),n.state.isSaving=!1,n.state.saveError=!1,n.initializeRunnableWorkflowService(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"initializeRunnableWorkflowService",value:function(){Dn.WorkflowsService=m.b,Dn.RunsService=Ct.a}},{key:"render",value:function(){var e=this.state,t=e.runnableWorkflow,n=e.isSaving,a=e.saveError;return r.a.createElement(Bn,{runnableWorkflow:t,onWorkflowEdited:this.onWorkflowEdited,onSave:this.onSave,isSaving:n,saveError:a})}}]),t}(Tn);n.d(t,"c",function(){return Pn}),n.d(t,"a",function(){return An}),n.d(t,"d",function(){return Fn}),n.d(t,"b",function(){return Ln});var Pn="/workflows",An="/public-workflows",Fn=function(){return r.a.createElement(o.a,null,r.a.createElement(c.a,{path:"".concat(Pn,"/:id"),exact:!0,component:Wn}))},Ln=function(){return r.a.createElement(o.a,null,r.a.createElement(c.a,{path:"".concat(An,"/:id"),exact:!0,component:Tn}))}},58:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(11),c=n(14),i=n(18),l=n(2),s=function e(t,n,a,r){var o=this;Object(l.a)(this,e),this.getId=function(){return o.id},this.getRunId=function(){return o.getId()},this.getBlockRuns=function(){return o.blockRuns},this.getBlockRun=function(e){return o.getBlockRuns().find(function(t){return t.getBlockId()===e})},this.getCreatedAt=function(){return o.createdAt},this.getWorkflowId=function(){return o.workflowId},this.isRunning=function(){return o.getRunningBlockRuns().length>0},this.getRunningBlockRuns=function(){return o.getBlockRuns().filter(function(e){return e.isRunning()})},this.isFailed=function(){return o.getFailedBlockRuns().length>0},this.getFailedBlockRuns=function(){return o.getBlockRuns().filter(function(e){return e.isFailed()})},this.isFinished=function(){return o.getFinishedBlockRuns().length===o.getBlockRuns().length},this.getFinishedBlockRuns=function(){return o.getBlockRuns().filter(function(e){return e.isFinished()})},this.id=t,this.blockRuns=n,this.createdAt=a,this.workflowId=r},u=n(69),d=n(77),p="".concat(i.a,"/runs"),f=function(e){var t=e.id,n=e.data,a=e.created_at,r=e.id_workflow,o=[];return Object.keys(n).forEach(function(e){var a=n[e];o.push(new u.b(a.state,t,a.id_cache,e))}),new s(t,o,new Date(a),r)},h=function(e,t){return t.getCreatedAt()-e.getCreatedAt()};t.a={getRuns:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getRuns("".concat(p));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getRunsOfWorkflow:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getRuns("".concat(p,"?workflowId=").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),_getRuns:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.a)(t);case 2:return n=e.sent,(a=n.map(f)).sort(h),e.abrupt("return",new d.a(a));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getDownloadLink:function(e,t){return"".concat(p,"/").concat(e.id,"/result?format=").concat(t)}}},69:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return l});var a=n(2),r=Object.freeze({FAILED:"runtimeError",RUNNING:"running",FINISHED:"finished",NOT_STARTED:"not started"}),o=r.FAILED,c=r.RUNNING,i=r.FINISHED,l=function e(t,n,r,l){var s=this;Object(a.a)(this,e),this.getBlockId=function(){return s.blockId},this.getState=function(){return s.state},this.getRunId=function(){return s.runId},this.getCacheId=function(){return s.cacheId},this.isRunning=function(){return s.getState()===c},this.isFailed=function(){return s.getState()===o},this.isFinished=function(){return s.getState()===i},this.blockId=l,this.state=t,this.runId=n,this.cacheId=r}},77:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(2),r=function e(t){var n=this;Object(a.a)(this,e),this.getLatestRun=function(){return n.runs[0]},this.containsRun=function(e){return null!=n.runs.find(function(t){return t.getId()===e})},this.getBlockRuns=function(e){return n.runs.map(function(t){return t.getBlockRun(e)}).filter(function(e){return!!e})},this.getFinishedRuns=function(){return n.runs.filter(function(e){return e.isFinished()})},this.getRunningRuns=function(){return n.runs.filter(function(e){return e.isRunning()})},this.runs=t}},81:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(38),r=function(e){return e.props.history.push("".concat(a.a))}},83:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return m}),n.d(t,"b",function(){return g});var a=n(2),r=n(3),o=n(6),c=n(4),i=n(7),l=n(0),s=n.n(l),u=n(465),d=n(463),p=n(464),f=n(33),h=n(38),m=(n(454),"/login"),g=function(t){function n(){var t,r;Object(a.a)(this,n);for(var i=arguments.length,l=new Array(i),m=0;m<i;m++)l[m]=arguments[m];return(r=Object(o.a)(this,(t=Object(c.a)(n)).call.apply(t,[this].concat(l)))).signInButtonRendered=!1,r.state={loggedIn:!1},r.renderRedirect=function(){return s.a.createElement(u.a,{to:h.a})},r.renderLogin=function(){return r.renderSignInButtonIfNeeded(),s.a.createElement(d.a,null,s.a.createElement(p.a,{style:{marginTop:"3em",textAlign:"center"}},s.a.createElement("h1",null,"Welcome to Crowdhub"),s.a.createElement("p",null,"Please login with your Google account to continue"),s.a.createElement("div",{id:"google-signin-button"})))},r.renderSignInButtonIfNeeded=function(){r.signInButtonRendered||(r.renderSignInButton(),r.signInButtonRendered=!0)},r.renderSignInButton=function(){return e(function(){f.a.renderSignInButton("google-signin-button",r.onSignedIn)})},r.onSignedIn=function(){return r.setState({loggedIn:!0})},r}return Object(i.a)(n,t),Object(r.a)(n,[{key:"render",value:function(){return this.state.loggedIn?this.renderRedirect():this.renderLogin()}}]),n}(l.Component)}).call(this,n(176).setImmediate)}},[[242,1,2]]]);
//# sourceMappingURL=main.3a669e7c.chunk.js.map